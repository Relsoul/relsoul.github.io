<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>干货！一步步实现自己的表单验证器 | Soul的随笔</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="转自http://www.gbtags.com/gb/share/5017.htm
表单验证的需求简直太常见了。“所有用户的输入都是不可信的”这个思想指导我们在设计表单的时候，一定要进行用户输入的验证。对于用户体验而言，越早的反馈则越佳，所以表单验证的工作应该尽可能地在前端就进行（当然，前端对于后端而言也是输入端，所以后端仍然需要进行检验）。简单的表单验证完全可以给input绑定几个change事">
<meta property="og:type" content="article">
<meta property="og:title" content="干货！一步步实现自己的表单验证器">
<meta property="og:url" content="http://emufan.com/2015/10/21/107ver/index.html">
<meta property="og:site_name" content="Soul的随笔">
<meta property="og:description" content="转自http://www.gbtags.com/gb/share/5017.htm
表单验证的需求简直太常见了。“所有用户的输入都是不可信的”这个思想指导我们在设计表单的时候，一定要进行用户输入的验证。对于用户体验而言，越早的反馈则越佳，所以表单验证的工作应该尽可能地在前端就进行（当然，前端对于后端而言也是输入端，所以后端仍然需要进行检验）。简单的表单验证完全可以给input绑定几个change事">
<meta property="og:image" content="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415121912.png">
<meta property="og:image" content="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415155218.png">
<meta property="og:updated_time" content="2015-10-21T14:57:05.755Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="干货！一步步实现自己的表单验证器">
<meta name="twitter:description" content="转自http://www.gbtags.com/gb/share/5017.htm
表单验证的需求简直太常见了。“所有用户的输入都是不可信的”这个思想指导我们在设计表单的时候，一定要进行用户输入的验证。对于用户体验而言，越早的反馈则越佳，所以表单验证的工作应该尽可能地在前端就进行（当然，前端对于后端而言也是输入端，所以后端仍然需要进行检验）。简单的表单验证完全可以给input绑定几个change事">
  
    <link rel="alternative" href="/atom.xml" title="Soul的随笔" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Soul</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Soul</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Soul</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-107ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/107ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      干货！一步步实现自己的表单验证器
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p></p><p>转自<a href="http://www.gbtags.com/gb/share/5017.htm" target="_blank" rel="external">http://www.gbtags.com/gb/share/5017.htm</a></p><p></p>
<p></p><p>表单验证的需求简直太常见了。“<strong>所有用户的输入都是不可信的</strong>”这个思想指导我们在设计表单的时候，一定要进行用户输入的验证。对于用户体验而言，越早的反馈则越佳，所以表单验证的工作应该尽可能地在前端就进行（当然，前端对于后端而言也是输入端，所以后端仍然需要进行检验）。简单的表单验证完全可以给input绑定几个change事件来进行。但表单一复杂，或者相似验证规则一多，这种编码的方式就很难管理事件了。这时候，我们通常需要使用一些库来帮助我们处理表单验证的工作。前端表单验证的库太多了，随便一搜：<a href="http://www.zhouhua.info/jump/z000" target="_blank">表单验证-百度搜索</a>。</p><p></p>
<p></p><p>那……为什么还要自己实现一个呢？因为去年工作中遇到了比较复杂的验证逻辑，选一个别人的库一是要学习api，二是维护起来困难，要符合自己的页面风格也不是那么轻松；再加上表单验证器并不复杂，于是就打算自己写一个。所以这个表单验证器并不算那么地通用，不过我觉得传播思路和方法更重要，要想修修改改变成一个通用的库也很容易，只是没那么重要罢了（其实是懒……）。</p><p></p>
<p></p><h2>依赖</h2><p></p>
<p></p><p>jquery + bootstrap。jquery看来是缺不了，bootstrap没那么重要，对代码稍做修改就可以取消依赖。</p><p></p>
<p></p><h2>能做什么</h2><p></p>
<p></p><p>我期望这个表单验证器直接在html代码中指定好需要采用什么样的规则，不需要用javascript进行多余的配置；允许暂时跳过验证；允许扩展验证规则；提供验证难过、验证失败、警告三种验证结果；允许手动触发验证等等。</p><p></p>
<p></p><p>一个典型的bootstrap风格的表单项应该长这个样子：</p><p></p>
<p><div class="jspContainer"></div></p>
<p><div class="jspPane"></div></p>
<p><ol class="linenums"></ol></p>
<p><li class="L0"><span class="tag">&lt;div</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“form-group”</span><span class="tag">&gt;</span></li></p>
<p><li class="L1"><span class="tag">&lt;label</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“col-xs-2 control-label”</span><span class="tag">&gt;</span><span class="pln">手机号码</span></li></p>
<p><li class="L2"><span class="tag">&lt;span</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“request”</span><span class="tag">&gt;</span><span class="pln">*</span><span class="tag">&lt;/span&gt;</span><span class="pln">：</span><span class="tag">&lt;/label&gt;</span></li></p>
<p><li class="L3"><span class="tag">&lt;div</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“col-xs-6”</span><span class="tag">&gt;</span></li></p>
<p><li class="L4"><span class="tag">&lt;input</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“form-control”</span> <span class="atn">name</span><span class="pun">=</span><span class="atv">“mobile”</span> <span class="atn">type</span><span class="pun">=</span><span class="atv">“text”</span> <span class="atn">data-validate-disable</span><span class="pun">=</span><span class="atv">“true”</span> <span class="atn">data-validate</span><span class="pun">=</span><span class="atv">“request:notrim mobile”</span> <span class="tag">/&gt;</span></li></p>
<p><li class="L5"><span class="tag">&lt;p</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“text-info”</span><span class="tag">&gt;</span><span class="pln">请输入真实手机号码。</span><span class="tag">&lt;/p&gt;</span></li></p>
<p><li class="L6"><span class="tag">&lt;/div&gt;</span></li></p>
<p><li class="L7"><span class="tag">&lt;div</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“help-block col-xs-4”</span><span class="tag">&gt;</span><span class="pln">&amp;nbsp;</span><span class="tag">&lt;/div&gt;</span></li></p>
<p><li class="L8"><span class="tag">&lt;/div&gt;</span></li><br><br></p>
<p><div class="jspVerticalBar"></div></p>
<p><div class="jspHorizontalBar"></div><br></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><p>重点看第5行，对于一个普通的input组件，我加了两个属性， data-validate-disable 有值表示表单验证时，会跳过这个input组件； data-validate 则存放如果要验证的话，将采用什么样的验证规则。这个例子中表示要验证这个input组件是否为空、是否为手机号码这两个规则。注意，在request 的后面我还加了一点内容，这是我想传递给验证规则的参数，比如这里我期望告诉验证器，如果input值只有空格，也认为是有值的。相似的，我们可以定义一个规则 min 来处理最少几个字符，并在html中把这个设定值传递进来，就像这样： data-validate=”min:10” 。我也期望一个验证规则允许多个参数传递，参数与参数之间用逗号隔开。</p><p></p>
<p></p><p>看起来很有意思，那就开始动手吧。</p><p></p>
<p></p><h2>先写个jquery插件吧</h2><p></p>
<p><div class="jspContainer"></div></p>
<p><div class="jspPane"></div></p>
<p><ol class="linenums"></ol></p>
<p><li class="L0"><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">)</span> <span class="pun">{</span></li></p>
<p><li class="L1"><span class="pln"> $</span><span class="pun">.</span><span class="pln">fn</span><span class="pun">.</span><span class="pln">validation </span><span class="pun">=</span> <span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li></p>
<p><li class="L2"><span class="kwd">return</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">each</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li></p>
<p><li class="L3"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li></p>
<p><li class="L4"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">))</span> <span class="pun">{</span></li></p>
<p><li class="L5"><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">);</span></li></p>
<p><li class="L6"><span class="pun">}</span></li></p>
<p><li class="L7"><span class="pln"> $this</span><span class="pun">.</span><span class="pln">off</span><span class="pun">(</span><span class="str">‘blur.zh select.zh focus.zh’</span><span class="pun">)</span></li></p>
<p><li class="L8"><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">‘blur.zh select.zh’</span><span class="pun">,</span><span class="pln"> validate</span><span class="pun">)</span></li></p>
<p><li class="L9"><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">‘focus.zh’</span><span class="pun">,</span><span class="pln"> clear</span><span class="pun">);</span></li></p>
<p><li class="L0"><span class="pun">});</span></li></p>
<p><li class="L1"><span class="pun">};</span></li></p>
<p><li class="L2"><span class="pun">}(</span><span class="pln">jQuery</span><span class="pun">));</span></li><br><br></p>
<p><div class="jspVerticalBar"></div><br></p>
<p></p><p>给jquery对象添加一个 validation 方法，用法很简单： $(Selector).validation() 。支持链式调用。<em>Selector</em>比较自由，如果是 :input 元素，则直接给这些元素初始化验证器；否则找出它们所有的 :input 子元素，给这些子元素初始化验证器。什么意思呢？就以上面的html片断为例，你可以任性地使用如下任意一种方式初始化验证器：</p><p></p>
<p><ul></ul></p>
<p><li>$(‘[name=mobile]’).validation(); // 选择:input</li></p>
<p><li>$(‘.form-group’).validation(); // 选择普通节点，对所有:input子元素生效</li></p>
<p><li>$(‘body’).validation(); // 对页面中所有的:input元素生效</li><br></p>
<p></p><p>再说说所谓的初始化，其实就是绑定事件。那么要绑定什么事件呢？主观上，对于一个输入框，当我们输入好了，焦点离开时，应该就进行输入内容的验证，并给出验证结果。如果验证失败，会有提示信息，但这些提示信息应该在重新获得焦点时清除，否则当用户在修正输入的时候还一直提示上次的错误信息，会让用户无所适从。那么针对以上的情况，我们需要在失去焦点（<em>blur</em>）和获得焦点（<em>focus</em>）时分别绑定验证的方法（<em>validate</em>）和清除错误信息的方法（<em>clear</em>）。另外针对checkbox、radiobox、select等控件，最好也给select事件绑定验证方法。</p><p></p>
<blockquote><p>为什么不使用更通用change事件来绑定验证方法呢？原因有二：</p><br><ol><br><li>我觉得有些场景需要用javascript载入默认值或历史输入。这些内容应该延后验证（不是不验证），不然刚打开页面就是表单验证错误让人很难受。所以change事件不合适。</li><br><li>由于获得焦点会清空错误消息，如果没有修改内容，直接失去焦点，这时不会触发change事件，导致不会再验证，表现为错误信息丢失。</li><br></ol><br></blockquote><br><p>那下面就来具体看看<em>validate</em>和<em>clear</em>两个方法。</p><br><h2>清除错误消息及验证状态设置</h2><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="kwd">function</span><span class="pln"> clear</span><span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$parent</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">)</span> <span class="pun">||</span></li><br><li class="L4"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">)</span> <span class="pun">===</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">prop</span><span class="pun">(</span><span class="str">‘name’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">,</span> <span class="kwd">null</span><span class="pun">).</span><span class="pln">removeClass</span><span class="pun">(</span><span class="str">‘has-error waiting has-warning’</span><span class="pun">)</span></li><br><li class="L6"><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘.help-block’</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="str">‘’</span><span class="pun">);</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"></li><br><li class="L0"><span class="kwd">function</span><span class="pln"> successHandler</span><span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$parent</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘.has-warning’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> clear</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"></li><br><li class="L7"><span class="kwd">function</span><span class="pln"> failHandler</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L9"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">removeClass</span><span class="pun">(</span><span class="str">‘has-warning waiting’</span><span class="pun">).</span><span class="pln">addClass</span><span class="pun">(</span><span class="str">‘has-error’</span><span class="pun">).</span></li><br><li class="L0"><span class="pln"> attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">,</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">prop</span><span class="pun">(</span><span class="str">‘name’</span><span class="pun">)).</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘.help-block’</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">);</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"></li><br><li class="L3"><span class="kwd">function</span><span class="pln"> warningHandler</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L5"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">removeClass</span><span class="pun">(</span><span class="str">‘waiting’</span><span class="pun">).</span><span class="pln">addClass</span><span class="pun">(</span><span class="str">‘has-warning’</span><span class="pun">).</span></li><br><li class="L6"><span class="pln"> attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">,</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">prop</span><span class="pun">(</span><span class="str">‘name’</span><span class="pun">)).</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘.help-block’</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">);</span></li><br><li class="L7"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><h2> 这一段一起说，因为这部分内容是dom操作相关的，与bootstrap强相关，如果你不用bootstrap，那就尽情地替换掉吧（估计改几个类名就行了）。这几个函数的用途从名字上就可以看出。clear上面已经提到过，清空验证信息；另外三个分别处理验证通过、验证失败和警告时的信息展示。简单是简单，但这里有两个问题需要额外考虑一下。</h2><br><p>第一个是验证信息优先级的问题：</p><br><p>一个输入项可能同时有多个验证规则要匹配，可能有些验证规则通过，有些失败，有些警告。在具体处理时，我觉得比较合理的流程是：如果出现验证失败，则立刻停止后续验证，直接提示错误信息；如果警告，则提示警告信息，并继续后续规则验证；如果验证成功，理论上不需要做任何处理，直接进行下一步验证，但谨慎起见，还是做一下清空错误信息的工作，但要注意不可以清空掉警告信息（错误信息不用管，因为一产生错误信息，验证也就停止了，不会再触发验证成功了）。</p><br><p>另一个问题是同一个表单单元中有多个输入控件的问题，就像这样：</p><br><p><img src="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415121912.png" data-original="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415121912.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="QQ20150415121912" width="586" height="96"></p><br><p>几个控件共用了一个错误信息展示文本，我觉得如果某一个控件输入内容有误，必须再次修改这个控件内容才能清空错误信息，修改别的控件时，这个错误信息应该保留。所以在清除错误信息时，我们额外需要知道这个错误信息是由哪个控件引起的。在上面的示例中，我们在处理验证错误和警告时，把引起问题的控件的<em>name</em>记录到表单单元的<em>data-for</em>属性中了。到需要清空的时候再比对一下<em>data-for</em>和当前控件的<em>name</em>是不是一致，不一致就不清空错误信息。</p><br><h2>处理验证流程</h2><br><p>我们给输入控件的<em>blur</em>和<em>select</em>事件绑定了<em>validate</em>方法，那么这个validate方法如何实现呢？</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="kwd">function</span><span class="pln"> validate</span><span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> success </span><span class="pun">=</span> <span class="kwd">new</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Callbacks</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> fail </span><span class="pun">=</span> <span class="kwd">new</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Callbacks</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> warning </span><span class="pun">=</span> <span class="kwd">new</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Callbacks</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">value</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> successHandler</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span></li><br><li class="L8"><span class="pun">});</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">value</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="pln"> failHandler</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span></li><br><li class="L1"><span class="pun">});</span></li><br><li class="L2"><span class="pln"> warning</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">value</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> warningHandler</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span></li><br><li class="L4"><span class="pun">});</span></li><br><li class="L5"><span class="pln"> clear</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘:disabled’</span><span class="pun">)</span> <span class="pun">||</span><span class="pln"> $this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘[data-validate-disable]’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L7"><span class="kwd">return</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$this</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-validate’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> conditions </span><span class="pun">=</span> <span class="pun">(</span><span class="pln">$this</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-validate’</span><span class="pun">)</span> <span class="pun">||</span> <span class="str">‘’</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">/\s+/</span><span class="pln">g</span><span class="pun">);</span></li><br><li class="L1"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span></li><br><li class="L2"><span class="pln"> conditions</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> condition </span><span class="pun">=</span><span class="pln"> conditions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></li><br><li class="L4"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">addClass</span><span class="pun">(</span><span class="str">‘waiting’</span><span class="pun">);</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">pickStrategy</span><span class="pun">(</span><span class="pln">condition</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">/[:,]/</span><span class="pln">g</span><span class="pun">),</span><span class="pln"> $this</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">,</span><span class="pln"> warning</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><p>先看这段代码的前一部分，我定义了三个$.Callbacks对象，分别用以处理不同验证结果的响应。从效果上，不用$.Callbacks对象，直接传递函数引用也是可行的，我是想把dom操作和验证逻辑分离开，用类似事件触发的异步形式来处理验证逻辑。</p><br><p>再看第17行，它规定了两种情形不执行验证，一种是控件被禁用，另一种是控件中存在<em>data-validate-disable</em>属性。这个不用多解释了。</p><br><p>重点看20~30行，这段是关键。第21行中，我们把<em>data-validate</em>中的内容按空白（空格、tab、换行）切割到一个数组<em>conditions</em>中，<em>conditions</em>中的每一项都是一条需要验证的规则。那么很自然地，遍历这个数组。再看第26行，引入了一个新的方法<em>pickStrategy</em>，很明显它是对这条规则进行验证。先别管它的实现，看看它接收的参数。还记得前面我们说要允许用 rule:param1,param2 的形式给验证规则传入参数吗？<em>pickStrategy</em>拿到的第一个参数就是 [rule, param1, param2] ，通过condition.spit(/[:,]/g) 解析出。第二个参数是当前处理的控件的jquery对象，后面三个分别是验证成功、失败、警告三种情形的回调对象。如果验证失败，<em>pickStrategy</em>应该返回 false ，同时中止验证，否则验证下一条规则。</p><br><h2>策略模式</h2><br><p>下面就要来说<em>pickStrategy</em>方法了，不过先要补充一点背景知识——策略模式。策略模式是一种设计模式。</p><br><p>设计模式是搞软件工程的人常常挂在嘴边的词汇，表示对设计的复用。当然前端开发在工程化的进程上每家公司情况各异，我估计绝大多数公司的前端开发并不考虑工程上的问题，只考虑完成需求。因而对于没有OO编程开发背景的前端开发而言，设计模式可能是陌生的，甚至程序设计（别紧张，没有在说程序编写）本身就是陌生的。由于工程化的忽略和javascript语言本身的优点（很多模式没必要实现）和缺点（很多模式无法实现），前端开发中很少提设计模式。那么前端开发者怎么理解设计模式呢？设计模式就是一系统问题（场景）的通用解决思路。比如有人觉得jquery的链式调用很好用，能很大程度降低工作量，于是在别的地方也用函数 return this; 的方式构造支持链式调用的函数，这就可以认为是一个模式（谈不上设计模式）。</p><br><p>那策略模式是为了解决什么问题，或应对什么场景的呢？如果干一件事、完成一个任务可以有不同的策略，不同的算法来完成，这些策略、算法应该具有相同的输入和输出，但可以使用不同的资源（即不care中间实现差异）。具体要采用什么策略和方法则在程序运行时依据条件选择。举个例子？</p><br><p><img src="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415155218.png" data-original="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415155218.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="QQ20150415155218" width="470" height="403"></p><br><p>压缩文件，你可以选择不同的算法，但它们拥有相同的输入和输出。</p><br><p>那么我们做表单验证跟策略模式有什么关系呢？我们完全可以把每个验证规则看作是一个策略，我们支持的所有的策略放在一起，取个高大上的名字叫“策略池”。当我们想验证一个规则的时候，只需要去策略池中取出这个策略跑一下，不需要在一个很大的函数里面跑一堆if…else，或者switch…case。另外如果有新的规则加进来，只要把它塞到策略池中，无需更改已有的代码，<strong>实现验证规则和验证流程解耦</strong>。</p><br><p>先实现一个策略池吧：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy </span><span class="pun">=</span> <span class="pun">{};</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>太棒了，一句代码就完事了，爱死javascript了！</p><br><p>再回到<em>pickStrategy</em>方法，看看怎么从这个策略池中拿到我们需要的验证规则：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="kwd">function</span><span class="pln"> pickStrategy</span><span class="pun">(</span><span class="pln">tokens</span><span class="pun">,</span><span class="pln"> scope</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">,</span><span class="pln"> warning</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> tokens</span><span class="pun">.</span><span class="pln">shift</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> strategy </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy</span><span class="pun">[</span><span class="pln">name</span><span class="pun">];</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">strategy</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="kwd">return</span><span class="pln"> strategy</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">scope</span><span class="pun">,</span><span class="pln"> tokens</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">,</span><span class="pln"> warning</span><span class="pun">);</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><p>先说这个<em>token</em>，还记得它是什么吗？如果要验证的规则是“min:5”，那么<em>token</em>就是 [‘min’,’5’] 这个数组。第2行取出这个数组的第一项 ‘min’ ，再从策略池中取出这个验证规则。如果没有这个规则，则跳过这次验证，认为此次通过；如果有这个规则，则执行这个规则（见第5行），需要注意一下第5行的<em>token</em>已经发生变化了，除去规则名称，只剩下参数了，延续前面的例子，这里<em>token</em>应该是 [‘5’] 。</p><br><p>现在我们的策略池是空的，那可不行，先试着写一个验证“min”规则的方法吧：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy</span><span class="pun">.</span><span class="pln">min </span><span class="pun">=</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">()</span> <span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span> <span class="pun">+(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L7"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;=</span><span class="pln"> length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请至少输入’</span> <span class="pun">+</span><span class="pln"> length </span><span class="pun">+</span> <span class="str">‘个字！’</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><p>这个方法内，<em>this</em>指向当前验证的控件的jquery对象，第1个参数是额外带给验证规则的参数；第2个参数是验证成功的回调，使用时需要配合 return true; （见9、10行）；第3个参数是验证失败的回调，使用是需要配合 return false; （见13、14行）；第4个参数是警告的回调，需要配合return true; ，这个验证中没用到。</p><br><p>起始的几个验证方法也可以直接写在策略池中，我写了几个，供大家参考：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants </span><span class="pun">=</span> <span class="pun">{</span></li><br><li class="L1"><span class="str">‘request’</span><span class="pun">:</span> <span class="str">/./</span><span class="pun">,</span></li><br><li class="L2"><span class="str">‘trimLeft’</span><span class="pun">:</span> <span class="str">/^\s+/</span><span class="pun">,</span></li><br><li class="L3"><span class="str">‘trimRight’</span><span class="pun">:</span> <span class="str">/\s+$/</span><span class="pun">,</span></li><br><li class="L4"><span class="str">‘trim’</span><span class="pun">:</span> <span class="str">/(^\s+)|(\s+$)/</span><span class="pln">g</span><span class="pun">,</span></li><br><li class="L5"><span class="str">‘number’</span><span class="pun">:</span> <span class="str">/^-?\d+(,\d{3,4})<em>(.\d+)?$/</em></span><span class="pun">,</span></li><br><li class="L6"><span class="str">‘purenumber’</span><span class="pun">:</span> <span class="str">/^\d+$/</span><span class="pun">,</span></li><br><li class="L7"><span class="str">‘shenfenzheng’</span><span class="pun">:</span> <span class="str">/^\d{17}[\dx]$/</span><span class="pln">i</span><span class="pun">,</span></li><br><li class="L8"><span class="str">‘taibaozheng’</span><span class="pun">:</span> <span class="str">/^\d{8}(\d{2})?$/</span><span class="pun">,</span></li><br><li class="L9"><span class="str">‘zhizhao’</span><span class="pun">:</span> <span class="str">/^\d{15}$/</span><span class="pun">,</span></li><br><li class="L0"><span class="str">‘mobile’</span><span class="pun">:</span> <span class="str">/^1[345789]\d{9}$/</span><span class="pun">,</span></li><br><li class="L1"><span class="str">‘telephone’</span><span class="pun">:</span> <span class="str">/^\d{7,8}([ +-]\d+)?$/</span><span class="pun">,</span></li><br><li class="L2"><span class="str">‘email’</span><span class="pun">:</span> <span class="str">/^[a-z0-9.-<em>+]+@[a-z0-9-</em>]+(.[a-z0-9-<em>]+)+$/</em></span><span class="pln">i</span><span class="pun">,</span></li><br><li class="L3"><span class="str">‘url’</span><span class="pun">:</span> <span class="str">/^(https?:\/\/)?(([\d]{1,3}.){3}[\d]{1,3}|([\d\w!~\‘()-]+.)<em>([\d\w][\d\w-]{0,61})?[\d\w].[\w]{2,6})(:[\d]{1,4})?((\/?)|(\/[\d\w_!~</em>\‘().;?:@&amp;=+$,%#-]+)+\/?)$/</span></li><br><li class="L4"><span class="pun">};</span></li><br><li class="L5"><span class="pln"> </span></li><br><li class="L6"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy </span><span class="pun">=</span> <span class="pun">{</span></li><br><li class="L7"><span class="str">‘request’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">“[type=checkbox]”</span><span class="pun">)</span> <span class="pun">||</span> <span class="kwd">this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">“[type=radio]”</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> name </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">“name”</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">name</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">(</span><span class="str">“[name=”</span> <span class="pun">+</span><span class="pln"> name </span><span class="pun">+</span> <span class="str">“]:checked”</span><span class="pun">).</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘不能为空！’</span><span class="pun">);</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L7"><span class="kwd">switch</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">toLowerCase</span><span class="pun">())</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">case</span> <span class="str">‘notrim’</span><span class="pun">:</span></li><br><li class="L9"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L0"><span class="kwd">case</span> <span class="str">‘trimleft’</span><span class="pun">:</span></li><br><li class="L1"><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">trimLeft</span><span class="pun">,</span> <span class="str">‘’</span><span class="pun">));</span></li><br><li class="L2"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L3"><span class="kwd">case</span> <span class="str">‘trimright’</span><span class="pun">:</span></li><br><li class="L4"><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">trimRight</span><span class="pun">,</span> <span class="str">‘’</span><span class="pun">));</span></li><br><li class="L5"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L6"><span class="kwd">default</span><span class="pun">:</span></li><br><li class="L7"><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">trim</span><span class="pun">,</span> <span class="str">‘’</span><span class="pun">));</span></li><br><li class="L8"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">request</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">()))</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘不能为空！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">},</span></li><br><li class="L9"><span class="str">‘min’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">()</span> <span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span> <span class="pun">+(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;=</span><span class="pln"> length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请至少输入’</span> <span class="pun">+</span><span class="pln"> length </span><span class="pun">+</span> <span class="str">‘个字！’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">},</span></li><br><li class="L0"><span class="str">‘max’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span> <span class="pun">+(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&lt;=</span><span class="pln"> length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L8"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘不能超过’</span> <span class="pun">+</span><span class="pln"> length </span><span class="pun">+</span> <span class="str">‘个字！’</span><span class="pun">);</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pun">},</span></li><br><li class="L7"><span class="str">‘number’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">}</span></li><br><li class="L3"><span class="pln"> condition </span><span class="pun">=</span><span class="pln"> condition </span><span class="pun">||</span> <span class="pun">[];</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">number</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入数字！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span></li><br><li class="L9"><span class="pln"> condition</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> condition</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">toLowerCase</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">c </span><span class="pun">===</span> <span class="str">‘pure’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">purenumber</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入0~9组成的数字！’</span><span class="pun">);</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="kwd">else</span> <span class="kwd">if</span> <span class="pun">(</span><span class="str">/^\d+[~-]\d+$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">c</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">var</span><span class="pln"> match </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="str">/\d+/</span><span class="pln">g</span><span class="pun">);</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length </span><span class="pun">&lt;</span> <span class="pun">+</span><span class="pln">match</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请至少输入’</span> <span class="pun">+</span><span class="pln"> match</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span> <span class="pun">+</span> <span class="str">‘位数字！’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length </span><span class="pun">&gt;</span> <span class="pun">+</span><span class="pln">match</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘最多只能输入’</span> <span class="pun">+</span><span class="pln"> match</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span> <span class="pun">+</span> <span class="str">‘位数字！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">else</span> <span class="kwd">if</span> <span class="pun">(</span><span class="str">/^\d+$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">c</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(+</span><span class="pln">c </span><span class="pun">!==</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入’</span> <span class="pun">+</span><span class="pln"> c </span><span class="pun">+</span> <span class="str">‘位数字！’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">},</span></li><br><li class="L9"><span class="str">‘mobile’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">mobile</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘手机号码输入有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">},</span></li><br><li class="L2"><span class="str">‘url’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">url</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">()))</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入正确的网址！如<a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a>‘</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">},</span></li><br><li class="L5"><span class="str">‘email’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">email</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘电子邮箱格式错误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">},</span></li><br><li class="L8"><span class="str">‘telephone’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">telephone</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘电话号码输入有误，请检查后重新输入！！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">},</span></li><br><li class="L1"><span class="str">‘shenfenzheng’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="pln"> value </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">shenfenzheng</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> numbers </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">‘’</span><span class="pun">);</span></li><br><li class="L0"><span class="com">// 验证地区</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> aCity </span><span class="pun">=</span> <span class="pun">{</span></li><br><li class="L2"><span class="lit">11</span><span class="pun">:</span> <span class="str">‘北京’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">12</span><span class="pun">:</span> <span class="str">‘天津’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">13</span><span class="pun">:</span> <span class="str">‘河北’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">14</span><span class="pun">:</span> <span class="str">‘山西’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">15</span><span class="pun">:</span> <span class="str">‘内蒙古’</span><span class="pun">,</span></li><br><li class="L7"><span class="lit">21</span><span class="pun">:</span> <span class="str">‘辽宁’</span><span class="pun">,</span></li><br><li class="L8"><span class="lit">22</span><span class="pun">:</span> <span class="str">‘吉林’</span><span class="pun">,</span></li><br><li class="L9"><span class="lit">23</span><span class="pun">:</span> <span class="str">‘黑龙江’</span><span class="pun">,</span></li><br><li class="L0"><span class="lit">31</span><span class="pun">:</span> <span class="str">‘上海’</span><span class="pun">,</span></li><br><li class="L1"><span class="lit">32</span><span class="pun">:</span> <span class="str">‘江苏’</span><span class="pun">,</span></li><br><li class="L2"><span class="lit">33</span><span class="pun">:</span> <span class="str">‘浙江’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">34</span><span class="pun">:</span> <span class="str">‘安徽’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">35</span><span class="pun">:</span> <span class="str">‘福建’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">36</span><span class="pun">:</span> <span class="str">‘江西’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">37</span><span class="pun">:</span> <span class="str">‘山东’</span><span class="pun">,</span></li><br><li class="L7"><span class="lit">41</span><span class="pun">:</span> <span class="str">‘河南’</span><span class="pun">,</span></li><br><li class="L8"><span class="lit">42</span><span class="pun">:</span> <span class="str">‘湖北’</span><span class="pun">,</span></li><br><li class="L9"><span class="lit">43</span><span class="pun">:</span> <span class="str">‘湖南’</span><span class="pun">,</span></li><br><li class="L0"><span class="lit">44</span><span class="pun">:</span> <span class="str">‘广东’</span><span class="pun">,</span></li><br><li class="L1"><span class="lit">45</span><span class="pun">:</span> <span class="str">‘广西’</span><span class="pun">,</span></li><br><li class="L2"><span class="lit">46</span><span class="pun">:</span> <span class="str">‘海南’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">50</span><span class="pun">:</span> <span class="str">‘重庆’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">51</span><span class="pun">:</span> <span class="str">‘四川’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">52</span><span class="pun">:</span> <span class="str">‘贵州’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">53</span><span class="pun">:</span> <span class="str">‘云南’</span><span class="pun">,</span></li><br><li class="L7"><span class="lit">54</span><span class="pun">:</span> <span class="str">‘西藏’</span><span class="pun">,</span></li><br><li class="L8"><span class="lit">61</span><span class="pun">:</span> <span class="str">‘陕西’</span><span class="pun">,</span></li><br><li class="L9"><span class="lit">62</span><span class="pun">:</span> <span class="str">‘甘肃’</span><span class="pun">,</span></li><br><li class="L0"><span class="lit">63</span><span class="pun">:</span> <span class="str">‘青海’</span><span class="pun">,</span></li><br><li class="L1"><span class="lit">64</span><span class="pun">:</span> <span class="str">‘宁夏’</span><span class="pun">,</span></li><br><li class="L2"><span class="lit">65</span><span class="pun">:</span> <span class="str">‘新疆’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">71</span><span class="pun">:</span> <span class="str">‘台湾’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">81</span><span class="pun">:</span> <span class="str">‘香港’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">82</span><span class="pun">:</span> <span class="str">‘澳门’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">91</span><span class="pun">:</span> <span class="str">‘国外’</span></li><br><li class="L7"><span class="pun">};</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">aCity</span><span class="pun">[</span><span class="pln">numbers</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span> <span class="pun">+</span><span class="pln"> numbers</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]])</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘身份证格式有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> wi </span><span class="pun">=</span> <span class="pun">[</span><span class="lit">7</span><span class="pun">,</span> <span class="lit">9</span><span class="pun">,</span> <span class="lit">10</span><span class="pun">,</span> <span class="lit">5</span><span class="pun">,</span> <span class="lit">8</span><span class="pun">,</span> <span class="lit">4</span><span class="pun">,</span> <span class="lit">2</span><span class="pun">,</span> <span class="lit">1</span><span class="pun">,</span> <span class="lit">6</span><span class="pun">,</span> <span class="lit">3</span><span class="pun">,</span> <span class="lit">7</span><span class="pun">,</span> <span class="lit">9</span><span class="pun">,</span> <span class="lit">10</span><span class="pun">,</span> <span class="lit">5</span><span class="pun">,</span> <span class="lit">8</span><span class="pun">,</span> <span class="lit">4</span><span class="pun">,</span> <span class="lit">2</span><span class="pun">];</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> check </span><span class="pun">=</span> <span class="pun">[</span><span class="str">‘1’</span><span class="pun">,</span> <span class="str">‘0’</span><span class="pun">,</span> <span class="str">‘x’</span><span class="pun">,</span> <span class="str">‘9’</span><span class="pun">,</span> <span class="str">‘8’</span><span class="pun">,</span> <span class="str">‘7’</span><span class="pun">,</span> <span class="str">‘6’</span><span class="pun">,</span> <span class="str">‘5’</span><span class="pun">,</span> <span class="str">‘4’</span><span class="pun">,</span> <span class="str">‘3’</span><span class="pun">,</span> <span class="str">‘2’</span><span class="pun">];</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> _sum </span><span class="pun">=</span> <span class="lit">0</span><span class="pun">;</span></li><br><li class="L5"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span> <span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span> <span class="lit">17</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> _sum </span><span class="pun">+=</span> <span class="pun">+</span><span class="pln">numbers</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span> <span class="pun"><em></em></span> <span class="pun">+</span><span class="pln">wi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">numbers</span><span class="pun">[</span><span class="lit">17</span><span class="pun">]</span> <span class="pun">!=</span><span class="pln"> check</span><span class="pun">[</span><span class="pln">_sum </span><span class="pun">%</span> <span class="lit">11</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘身份证格式有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入18位身份证！’</span><span class="pun">);</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">},</span></li><br><li class="L0"><span class="str">‘taibaozheng’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">taibaozheng</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘台胞证格式有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">},</span></li><br><li class="L3"><span class="str">‘zhizhao’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">zhizhao</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> p </span><span class="pun">=</span> <span class="lit">10</span><span class="pun">;</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> s</span><span class="pun">;</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> a</span><span class="pun">;</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> numbers </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">‘’</span><span class="pun">);</span></li><br><li class="L4"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span> <span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span> <span class="lit">15</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> a </span><span class="pun">=</span> <span class="pun">+</span><span class="pln">numbers</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></li><br><li class="L6"><span class="pln"> s </span><span class="pun">=</span> <span class="pun">(</span><span class="pln">p </span><span class="pun">%</span> <span class="lit">11</span><span class="pun">)</span> <span class="pun">+</span><span class="pln"> a</span><span class="pun">;</span></li><br><li class="L7"><span class="pln"> p </span><span class="pun">=</span> <span class="pun">(</span><span class="pln">s </span><span class="pun">%</span> <span class="lit">10</span><span class="pun">)</span> <span class="pun"></span> <span class="lit">2</span><span class="pun">;</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">p </span><span class="pun">===</span> <span class="lit">0</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> p </span><span class="pun">=</span> <span class="lit">20</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">s </span><span class="pun">%</span> <span class="lit">10</span> <span class="pun">!==</span> <span class="lit">1</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘工商营业执照输入有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L0"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入15位工商营业执照！’</span><span class="pun">);</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">}</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">};</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br><div class="jspHorizontalBar"></div><br></div><br><p>&nbsp;</p><br><p>&nbsp;</p><br><h2>添加验证规则</h2><br><p>说好的支持自定义验证规则呢？放心，不会少的，而且超简单：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation </span><span class="pun">=</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> process</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> $</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy</span><span class="pun">[</span><span class="pln">condition</span><span class="pun">]</span> <span class="pun">=</span><span class="pln"> process</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">};</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>加个静态方法搞定。</p><br><h2>手动发起验证</h2><br><p>有些场景下需要手动check一下表单内容才放心吧：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">fn</span><span class="pun">.</span><span class="kwd">exec</span> <span class="pun">=</span> <span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">each</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L4"><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">);</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pln"> $this</span><span class="pun">.</span><span class="pln">blur</span><span class="pun">();</span></li><br><li class="L7"><span class="pun">});</span></li><br><li class="L8"><span class="pun">};</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>原理很简单，对:input子元素触发一次blur事件。</p><br><h2>还有一些是我没有做的</h2><br><p>都不是很复杂，因为我的业务场景不关注这些，所以就懒过去了。</p><br><ol><br><li>没做通用的ajax验证<br><br>现在对于ajax的验证，可以这样做：<p></p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">(</span><span class="str">‘ajax_xx’</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> f</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> $</span><span class="pun">.</span><span class="pln">post</span><span class="pun">(</span><span class="str">‘some_url’</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">data</span><span class="pun">){</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">data</span><span class="pun">.</span><span class="pln">success</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> s</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L4"><span class="pun">}</span><span class="kwd">else</span><span class="pun">{</span></li><br><li class="L5"><span class="pln"> f</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘xxxxxxxx’</span><span class="pun">);</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="pun">});</span></li><br><li class="L8"><span class="pun">});</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>表单提交前，除了检查有没有.has-error的元素找到填写出错项，还要检查有没有.wait元素，如果有的话都不能立刻提交。<br><br>如果要有一个通用的ajax验证机制，可以自行扩展<em>$.validation</em>方法</p></li><br><li>没做验证失败时表单提交阻断<br><br>正如上一条中说的，表单提交前，需要检查.has-error和.wait元素，可以自行扩展<em>$.fn.validation</em>方法，添加form的submit事件绑定。</li><br><li>没有为handle验证状态的dom操作提供接口<br><br>不想做，bootstrap挺好的。</li><br><li>没有测试用例<br><br>不打算给这些代码添加逻辑了，不想写测试用例。</li><br></ol><br><h2>下载</h2><br><p><a href="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/validation.js" target="_blank">validation.js</a></p><br><blockquote><p>博客地址：<a href="http://www.zhouhua.info/2015/04/15/validation/" target="_blank">http://www.zhouhua.info/2015/04/15/validation/</a></p></blockquote>





      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/10/21/106ver/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          深入理解Javascript之this关键字
        
      </div>
    </a>
  
  
    <a href="/2015/10/21/108ver/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">谈谈正则表达式中的“.”</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="107ver" data-title="干货！一步步实现自己的表单验证器" data-url="http://emufan.com/2015/10/21/107ver/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"relsoul"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Soul
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>