<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Soul的随笔</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Soul的随笔">
<meta property="og:url" content="http://emufan.com/page/15/index.html">
<meta property="og:site_name" content="Soul的随笔">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Soul的随笔">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Soul的随笔" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?aa495dca780db3bca4942d20b6eda966";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Soul</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/code/" style="font-size: 15px;">code</a> <a href="/tags/jade/" style="font-size: 10px;">jade</a> <a href="/tags/mongoose/" style="font-size: 10px;">mongoose</a> <a href="/tags/了不起的nodejs/" style="font-size: 20px;">了不起的nodejs</a> <a href="/tags/自言语/" style="font-size: 10px;">自言语</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://emufan.com/">soul随笔</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Soul</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Soul</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-96ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/96ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/96ver/">php自学笔记之运算符</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote><br><h1 style="text-align: center;"><span style="color: #993366;"><strong>运算符</strong></span></h1><br><p><span style="color: #993366;"><strong>1,PHP中的算术运算符</strong></span></p><br><p align="left">算术运算符主要是用于进行算术运算的，例如：加法运算、减法运算、乘法运算、除法运算。在PHP中的常用的算术运算符对应下表：</p><br><p align="left"><a href="http://img.mukewang.com/5333bfdb0001a27a05300240.jpg" target="_blank" rel="external"><img class=" alignleft" src="http://img.mukewang.com/5333bfdb0001a27a05300240.jpg" data-original="http://img.mukewang.com/5333bfdb0001a27a05300240.jpg" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt=""></a></p><br><p align="left">$english=110;//英语成绩哪有这么好- -</p><br><p>$math=118;//向前移一个小数点就差不多了<br><br>$biological=80;//生物<br><br>$physical=90;//物理</p><br><p>$sum=$english+$math+$biological+$physical;<br><br>$avg=$sum/4;<br><br>$x=$math-$english;<br><br>$x2=$english*$english;<br><br>echo “总分:”.$sum.”&lt;br&gt;”;<br><br>echo “平均分:”.$avg.”&lt;br&gt;”;<br><br>echo “数学比英语高多少分:”.$x.”&lt;br&gt;”;<br><br>echo “英语平方:”.$x2.”&lt;br&gt;”;</p><br><p>&nbsp;</p><br><hr><br><p>&nbsp;</p><br><p><span style="color: #993366;"><strong>2,赋值运算符</strong></span></p><br><p align="left">PHP的赋值运算符有两种，分别是：</p><br><p align="left">(1)“=”：把右边表达式的值赋给左边的运算数。它将右边表达式值复制一份，交给左边的运算数。换而言之，首先给左边的运算数申请了一块内存，然后把复制的值放到这个内存中。</p><br><p align="left">(2)“&amp;”：引用赋值，意味着两个变量都指向同一个数据。它将使两个变量共享一块内存，如果这个内存存储的数据变了，那么两个变量的值都会发生变化。</p><br><p> //现在开始赋值运算符<br><br>$word1=”soul”;<br><br>$s_word1=$word1;<br><br>$c_word1=&amp;$word1;//$符号只相当于一个指针,当数据发生变化后赋值一样会发生变化<br><br>$word1=”soulseeker”;<br><br>echo $s_word1.”&lt;br&gt;”;<br><br>echo $c_word1.”&lt;br&gt;”</p><br><hr><br><p><span style="color: #993366;"><strong>3,比较运算符</strong></span></p><br><p>比较运算符主要是用于进行比较运算的，例如：等于、全等、不等、大于、小于。在PHP中常用的比较运算符如下表：</p><br><p><a href="http://img.mukewang.com/533a0af30001e75c06600409.jpg" target="_blank" rel="external"><img src="http://img.mukewang.com/533a0af30001e75c06600409.jpg" data-original="http://img.mukewang.com/533a0af30001e75c06600409.jpg" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt=""></a></p><br><p>&nbsp;</p><br><p>$t1=1;<br><br>$t2=”1”;</p><br><p>var_dump( $t1==$t2);//普通=，只会比较值是否一样<br><br>br();<br><br>var_dump($t1===$t2);//严格等于,会连类型都判断<br><br>br();<br><br>var_dump($t1!=$t2);//普通不等<br><br>br();<br><br>var_dump($t1!==$t2);//如果t1不等于t2,或者他们类型不同返回true<br><br>br();<br><br>var_dump($t1&lt;&gt;$t2);//不等 同等于!=<br><br>br();<br><br>var_dump($t1&gt;=$t2);//大于等于，小于等于都不会去判断数据类型<br><br>br();<br><br>var_dump($t1&lt;=$t2);//<br><br>br();<br><br>var_dump($t1&gt;$t2);//大于，小于会严格判断数据和数据类型</p><br><hr><br><p id="J_CodeLang" class="code-head" data-lang="PHP"><span style="color: #993366;"><strong>4,三元运算符</strong></span></p><br><div id="J_CodeDescr" class="code-description"><br><div class="code-desc co"><br><p>(“?:”)三元运算符也是一个比较运算符，对于表达式(expr1)?(expr2):(expr3)，如果expr1的值为true，则此表达式的值为expr2，否则为expr3。</p><br></div><br></div><br><p>$t3=78;</p><br><p>$t4=$t3&gt;60?”我及格了”:”我没及格”;<br><br>echo $t4;</p><br><hr><br><p>&nbsp;</p><br><p><span style="color: #993366;"><strong>5,逻辑运算符 </strong></span></p><br><p align="left">逻辑运算符主用是进行逻辑运算的，例如：逻辑与、逻辑或、逻辑异或、逻辑非等，在PHP中常用的逻辑运算符如下表：（点击看大图）</p><br><p align="left"><a href="http://img.mukewang.com/533e0fbe0001c56f06080279.jpg" target="_blank" rel="external"><img src="http://img.mukewang.com/533e0fbe0001c56f06080279.jpg" data-original="http://img.mukewang.com/533e0fbe0001c56f06080279.jpg" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt=""></a></p><br><p align="left">我们可以从投票的角度来理解逻辑运算：</p><br><p align="left"><strong>1、逻辑与：</strong>要求所有人都投票同意，才会通过某协议；</p><br><p align="left"><strong>2、逻辑或：</strong>只要求一个人投票同意就行；</p><br><p align="left"><strong>3、逻辑异或：</strong>只能有且只能有一个人投票同意；</p><br><p align="left"><strong>4、逻辑非：</strong>某个人要反对，但是通过逻辑非，使其反对无效；</p><br><p align="left">“与”和“或”有两种不同形式运算符的原因是它们运算的优先级（就是运算的有限顺序，比如我们小学的时候学习四则运算，加减乘除混合在一起啦，优先计算乘除，再计算加减）不同。</p><br><p align="left">//现在开始逻辑运算符<br><br>$a = TRUE; //A同意<br><br>$b = TRUE; //B同意<br><br>$c = FALSE; //C反对<br><br>$d = FALSE; //D反对<br><br>//咱顺便复习下三元运算符<br><br>echo ($a and $b)?”通过”:”不通过”;<br><br>echo “&lt;br /&gt;”;<br><br>echo ($a or $c)?”通过”:”不通过”;<br><br>echo “&lt;br /&gt;”;<br><br>echo ($a xor $c xor $d)?”通过”:”不通过”;//a或者b只有一个为true返回true<br><br>echo “&lt;br /&gt;”;<br><br>echo !$c?”通过”:”不通过”;<br><br>echo “&lt;br /&gt;”;<br><br>echo ($a&amp;&amp;$d)?”通过”:”不通过”;<br><br>echo “&lt;br /&gt;”;<br><br>echo($a||$b||$c)?”通过”:”不通过”;</p><br><hr><br><p id="J_CodeLang" class="code-head" data-lang="PHP"><strong><span style="color: #993366;">6,字符串连接运算符</span></strong></p><br><div id="J_CodeDescr" class="code-description"><br><div class="code-desc co"><br><p align="left">字符串连接运算符是为了将两个字符串进行连接，PHP中提供的字符串连接运算符有：</p><br><p align="left">（1）连接运算符(“.”)：它返回将右参数附加到左参数后面所得的字符串。</p><br><p align="left">（2）连接赋值运算符(“.=”)：它将右边参数附加到左边的参数后。</p><br></div><br></div><br><p>//现在开始字符串连接符<br><br>$a = “张先生”;<br><br>$tip=$a.”,欢迎您在慕课网学习PHP”;</p><br><p>$b = “东边日出西边雨”;<br><br>$b.=”,道是无晴却有晴”;//等同于$c=$c.”,道是无晴却有晴”;</p><br><p>$c = “东边日出西边雨”;<br><br>$c=$c.”,道是无晴却有晴”;</p><br><p>echo $tip.”&lt;br /&gt;”;<br><br>echo $b.”&lt;br /&gt;”;<br><br>echo $c.”&lt;br /&gt;”;</p><br><hr><br><p><span style="color: #993366;"><strong>7，错误控制运算符</strong></span></p><br><div id="J_CodeDescr" class="code-description"><br><div class="code-desc co"><br><p align="left">PHP中提供了一个错误控制运算符“@”，对于一些可能会在运行过程中出错的表达式时，我们不希望出错的时候给客户显示错误信息，这样对用户不友好。于是，可以将@放置在一个PHP表达式之前，该表达式可能产生的任何错误信息都被忽略掉；</p><br><p align="left">如果激活了track_error（这个玩意在php.ini中设置）特性，表达式所产生的任何错误信息都被存放在变量$php_errormsg中，此变量在每次出错时都会被覆盖，所以如果想用它的话必须尽早检查。</p><br><p align="left">需要注意的是：错误控制前缀“@”不会屏蔽解析错误的信息，不能把它放在函数或类的定义之前，也不能用于条件结构例如if和foreach等。</p><br></div><br></div><br><p>$conn=@mysql_connect(“localhost”,”username”,”password”);//@只能放在表达式中,不能放在foreach等循环中<br><br>echo “出错了，错误原因是：”.$php_errormsg;</p><br><hr><br><p>&nbsp;</p><br><p>8,运算符2</p><br><p>$maxLine = 4; //每排人数<br><br>$no = 17;//学生编号<br><br>$line=ceil($no/$maxLine);//判断座位<br><br>$row=$no%$maxLine?$no%$maxLine:$maxLine;//是否除尽？ 否取余数 是取$maxLine</p><br><p>echo “编号&lt;b&gt;”.$no.”&lt;/b&gt;的座位在第&lt;b&gt;”.$line.”&lt;/b&gt;排第&lt;b&gt;”.$row.”&lt;/b&gt;个位置”;</p><br><p>&nbsp;</p><br><p>&nbsp;</p><br><p>&nbsp;</p></blockquote>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-126ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/126ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/126ver/">利用CSS写一个短信对话框</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&nbsp;</p><br><p>演示地址:<a href="http://www.old.com/demo/css-%E5%AF%B9%E8%AF%9D%E6%B0%94%E6%B3%A1.html" target="_blank" rel="external">http://www.old.com/demo/css-%E5%AF%B9%E8%AF%9D%E6%B0%94%E6%B3%A1.html</a></p><br><p>&nbsp;</p><br><blockquote><br><h1><span style="color: #993366;"><strong>分析</strong></span></h1><br><p>其实很简单</p><br><p>做两个小三角形</p><br><p>一个是红色的</p><br><p>一个是白色的</p><br><p>然后通过定位定位元素即可.</p></blockquote><br><p>&nbsp;</p><br><p>&nbsp;</p><br><pre class="lang:default decode:true ">&lt;!doctype html&gt;<br>&lt;html lang=”en”&gt;<br>&lt;head&gt;<br>    &lt;meta charset=”UTF-8”&gt;<br>    &lt;title&gt;Document&lt;/title&gt;<br>    &lt;style type=”text/css”&gt;<br>    .talk{<br>        margin: 100px auto;<br>        padding: 50px;<br>        width:     200px;<br>        height: 100px;<br>        border: 5px solid red;<br>        position: relative;<br>    }<br>    .talk_bot{<br>        width: 0;<br>        height: 0;<br>        border-top:15px solid transparent;<br>        border-right: 20px solid red;<br>        border-bottom:15px solid transparent;<br>        position:absolute;<br>        left: -25px;<br>        top: 90px;<br><br>    }<br>    .talk_top{<br>        width: 0;<br>        height: 0;<br>        border-top:15px solid transparent;<br>        border-right: 20px solid #fff;<br>        border-bottom:15px solid transparent;<br>        position:absolute;<br>        left: -15px;<br>        top: 90px;<br><br>    }<br><br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>    &lt;div class=”talk”&gt;<br>        &lt;p&gt;CSS对话边框&lt;/p&gt;<br>        &lt;span class=”talk_bot”&gt;&lt;/span&gt;<br>        &lt;span class=”talk_top”&gt;&lt;/span&gt;<br>    &lt;/div&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</pre><br><p>&nbsp;</p>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-102ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/102ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/102ver/">RAINBOW GIRL</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>虽然很久以前就听到过这首歌了.</p><br><p>不过最近听到另一种风格的.</p><br><p>附上B站地址<a href="http://www.bilibili.com/video/av64435/" target="_blank" rel="external">http://www.bilibili.com/video/av64435/</a></p><br><p><a href="http://7xi9fb.com1.z0.glb.clouddn.com/mm/imgs/2015-10-21-QQ.png" target="_blank" rel="external"><img class=" size-medium wp-image-500 alignnone" src="http://7xi9fb.com1.z0.glb.clouddn.com/mm/imgs/2015-10-21-QQ.png" data-original="http://www.old.com/wp-content/uploads/2015/05/QQ截图20150517220321-300x235.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="QQ截图20150517220321" width="300" height="235"></a></p><br><p>&nbsp;</p><br><p>&nbsp;</p><br><p>另外附上无损下载地址<br><br><div class="down shortcodestyle icon-download"><a href="http://pan.baidu.com/s/1bnuEAYj" target="_blank">度娘下载</a></div><br><br>&nbsp;</p><br><p>&nbsp;</p><br><p>&nbsp;</p>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-103ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/103ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/103ver/">git Shell个人学习笔记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p></p><p><span style="font-size: 18pt;"> </span></p><p></p>
<p></p><p><span style="color: #993366; font-family: 'arial black', 'avant garde'; font-size: 18pt;"><strong>本文是GitHub个人学习笔记.</strong></span></p><p></p>
<blockquote><br><h1 style="text-align: center;"><span style="color: #993366; font-family: 'arial black', 'avant garde'; font-size: 18pt;"><strong>下载与安装GitHub</strong></span></h1><br><p><span style="font-family: 'arial black', 'avant garde'; font-size: 14pt;">下载 GitHub For Windows :<a href="https://windows.github.com/" target="_blank" rel="external">https://windows.github.com/</a></span></p><br><p><span style="font-family: 'arial black', 'avant garde'; font-size: 14pt;">PS:推荐架设VPN..下载和访问速度不忍直视啊</span></p></blockquote><br><p><span style="font-size: 18pt;"> </span></p><br><blockquote><br><p style="text-align: center;"><span style="font-family: 'arial black', 'avant garde'; font-size: 18pt;"><strong><span style="color: #993366;">Git Shell</span></strong></span></p><br><h3><span style="color: #993366; font-size: 14pt;"><strong>创建版本库</strong></span></h3><br><p><span style="font-family: 'arial black', 'avant garde'; font-size: 14pt;">在桌面打开Git Shell即进入了shell模式</span></p><br><p><span style="color: #993366; font-family: 'arial black', 'avant garde'; font-size: 14pt;">新建文件夹&gt;&gt;  mkdir</span><span style="color: #993366; font-size: 14pt;">初始化版本库&gt;&gt; git init</span></p><br><hr><br><p><span style="font-size: 14pt; color: #993366;"><strong>添加文件</strong></span></p><br><p>添加文件&gt;&gt;git add [file1 file2 file3…]</p><br><p>提交文件到仓库&gt;&gt;git commit -m  “第一次提交文件压力山大”</p><br><hr><br><p><span style="color: #993366; font-size: 14pt;"><strong>回溯</strong></span></p><br><p>查看是否存在改动未提交的文件&gt;&gt;git status</p><br><p>查看文件改动信息&gt;&gt;git diff</p><br><p>查看git改动日志&gt;&gt;git log</p><br><p>简单显示git改动日志&gt;&gt;git log –pretty=oneline</p><br><p>回溯git&gt;&gt;git re<span class="operator"><span class="keyword">set</span> –hard HEAD^  一个^代表回溯到上一个版本^^两个回溯到上上个版本….</span></p><br><p>显示回溯日志&gt;&gt;git reflog</p><br><p>回溯git(通过commit id)&gt;&gt;git re<span class="operator"><span class="keyword">set</span> –hard <span class="number">3628164</span></span></p><br><hr><br><p><span style="color: #993366; font-size: 14pt;"><strong>工作区与暂存区详细说明:</strong></span><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013745374151782eb658c5a5ca454eaa451661275886c6000" target="_blank" rel="external">click</a></p><br><hr><br><p><span style="color: #993366; font-size: 14pt;"><strong>git add提交说明</strong></span></p><br><p>git做的是修改管理，修改包括.文件,动作</p><br><p>比如第一次我在readme.txt文件写了一行</p><br><p>hello world</p><br><p>然后用git add命令进行添加,但是我突然想写一行</p><br><p>bey bey</p><br><p>于是修改后不再次添加直接 git commit -m “xxx”</p><br><p>然后再执行git status发现还有个readme.txt文件修改未被提交</p><br><p>原理很简单</p><br><p>第一次add添加的是hello world 这个文件放到了缓存区</p><br><p>然后你又添加了一行代码 beybey 于是这个文件又被放到了缓存区</p><br><p>也就是说缓存区有两个readme.txt</p><br><p>理解了后就好办了,可以第一次修改的时候不add readme.txt</p><br><p>或者第二次修改后再次使用 add readme.txt合并两个文件 再进行git commit -m添加</p><br><p>用<span style="color: #993366;"><strong>git diff HEAD – readme.txt</strong></span>命令可以查看工作区和版本库里面最新版本的区别：</p><br><hr><br><h4><span style="color: #993366; font-size: 14pt;"><strong>撤销修改</strong></span></h4><br><p>回到最近一次<code>git commit</code>或<code>git add</code>时的状态&gt;&gt;git checkout – readme.txt</p><br><p>添加到缓存区后撤销操作&gt;&gt;git reset HEAD file (然后再用checkout命令继续撤销)</p><br><p>撤销添加到本地仓库未添加到远程仓库&gt;&gt;git re<span class="operator"><span class="keyword">set</span> –hard HEAD^</span></p><br><hr><br><p>&nbsp;</p><br><p><span style="color: #993366; font-size: 14pt;"><strong>删除文件</strong></span></p><br><p>从版本库中删除文件&gt;&gt;git rm flie</p><br><p>接着再提交动作 git commit -m “删除一个文件”</p><br><hr><br><p><span style="color: #993366; font-size: 14pt;"><strong> 远程仓库</strong></span></p><br><p>添加远程库&gt;&gt;git remote add 代号(自行填写) git<span class="variable">@github</span>.<span class="symbol">com:你的账户名</span>/仓库名.git</p><br><pre class="">错误提示：(本地已经存在这个远程仓库) fatal: remote origin already exists.</pre><br><pre class="">解决办法：(移除这个远程仓库) git remote rm origin</pre><br><p>推送文件至远程库&gt;&gt;git push -u origin master</p><br><p>PS：由于远程库是空的，我们第一次推送<code>master</code>分支时，加上了<code>-u</code>参数，Git不但会把本地的<code>master</code>分支内容推送的远程新的<code>master</code>分支，还会把本地的<code>master</code>分支和远程的<code>master</code>分支关联起来，在以后的推送或者拉取时就可以简化命令。</p><br><p>要关联一个远程库，使用命令<code>git remote add origin git@server-name:path/repo-name.git</code>；</p><br><p>关联后，使用命令<code>git push -u origin master</code>第一次推送master分支的所有内容；</p><br><p>此后，每次本地提交后，只要有必要，就可以使用命令<code>git push origin master</code>推送最新修改；</p><br><hr><br><p><span style="font-size: 14pt;"><strong><span style="color: #993366;">  克隆远程库</span></strong></span></p><br><p>git clone git<span class="variable">@github</span>.<span class="symbol">com:账户名</span>/仓库名.git</p><br><p>&nbsp;</p><br><hr><br><p><span style="color: #800080; font-size: 14pt;"><strong>创建与合并分支</strong></span></p><br><p><span style="color: #333333;">创建切换到dev分支&gt;&gt;git checkout -b dev</span></p><br><p><code>git checkout</code>命令加上<code>-b</code>参数表示创建并切换，相当于以下两条命令：</p><br><pre><code class="ruby"><span class="variable">$ </span>git branch dev<br><span class="variable">$ </span>git checkout dev</code></pre><br><p>查看当前分支&gt;&gt;git branch （<code>git branch</code>命令会列出所有分支，当前分支前面会标一个<code>*</code>号）</p><br><p>切换分支&gt;&gt;git checkout 分支名</p><br><p>合并分支&gt;&gt;git merge 分支名（移动到其他分支后使用此命令合并分支名)</p><br><p>删除分支&gt;&gt;git branch -d 分支名</p><br><p>合并远程仓库&gt;&gt;git merge soul/master</p><br><p>&nbsp;</p><br><hr><br><p><span style="color: #800080; font-size: 14pt;"><strong>解决合并冲突</strong></span></p><br><p>首先创建一个git checkout -b soul分支soul</p><br><p>然后再readme.txt文件增加一行</p><br><p>soul readme</p><br><p>提交一下readme.txt</p><br><p>然后切换回master分支</p><br><p>然后修改master分支下的readme.txt</p><br><p>master readme</p><br><p>提交一下readme.txt</p><br><p>然后执行一下合并git merge soul</p><br><p>Auto-merging readme.txt<br><br>CONFLICT (content): Merge conflict in readme.txt<br><br>Automatic merge failed; fix conflicts and then commit the result.</p><br><p>发现会报错 git无法执行快速合并</p><br><p>用git status也会提示冲突文件</p><br><p>于是我们需要手动处理</p><br><p>查看readme.txt文件</p><br><p>Git用<code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>，<code>=======</code>，<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>标记出不同分支的内容</p><br><p>我们修改readme.txt文件</p><br><p>删除git生成的&lt;&lt;&lt;&lt;&lt; ====== &gt;&gt;&gt;&gt;&gt;&gt;然后把test分支上readme.txt的内容添加到readme.txt里就ok了</p><br><p>然后git add readme.txt git commit -m “fix”</p><br><hr><br><h4><span style="font-size: 14pt; color: #993366;"><strong>分支管理策略</strong></span></h4><br><p>通常合并分支git都是使用Fast forward，但这种模式下，删除分支后，会丢掉分支信息</p><br><p>如果要强制禁用<code>Fast forward</code>模式，Git就会在merge时生成一个新的commit，这样，从分支历史上就可以看出分支信息。</p><br><p><span class="variable">$ </span>git merge –no-ff -m <span class="string">“merge with no-ff”</span> dev</p><br><p><span class="constant">Merge</span> made by the <span class="string">‘recursive’</span> strategy. readme.txt | <span class="number">1</span> +</p><br><p><span class="number">1</span> file changed, <span class="number">1</span> insertion(+)</p><br><p>因为本次合并要创建一个新的commit，所以加上<code>-m</code>参数，把commit描述写进去。</p><br><p>Git分支十分强大，在团队开发中应该充分应用。</p><br><p>合并分支时，加上<code>–no-ff</code>参数就可以用普通模式合并，合并后的历史有分支，能看出来曾经做过合并，而<code>fast forward</code>合并就看不出来曾经做过合并。</p><br><hr><br><p>&nbsp;</p><br><p><span style="color: #993366; font-size: 14pt;"><strong>Bug分支</strong></span></p><br><p>比如我在dev分支下修改readme.txt时需要去master分支上修改一个bug</p><br><p>于是我可以利用</p><br><p>储藏&gt;&gt;git stash</p><br><p>当前的工作 然后切换至master上创建一个临时分支bugfix然后修改readme.txt</p><br><p>修改完毕后git add readme.txt; git commit -m “fixbug”</p><br><p>然后切换到master分支来</p><br><p>git merge –no-ff -m <span class="string">“merged bug fix 101”</span> bugfix</p><br><p>合并下bugfix 然后</p><br><p>git branch -d bugfix</p><br><p>删除这个分支</p><br><p>切换到dev分支</p><br><p>工作现场还在，Git把stash内容存在某个地方了，但是需要恢复一下，有两个办法：</p><br><p>一是用<code>git stash apply</code>恢复，但是恢复后，stash内容并不删除，你需要用<code>git stash drop</code>来删除；</p><br><p>另一种方式是用<code>git stash pop</code>，恢复的同时把stash内容也删了：再用<code>git stash list</code>查看，就看不到任何stash内容了：</p><br><p>利用 git stash pop恢复下内容 就可以继续工作了</p><br><hr><br><p>&nbsp;</p><br><p><span style="color: #993366; font-size: 14pt;"><strong>强行删除分支 </strong></span></p><br><p>在未合并分支的情况下删除分支</p><br><p>git branch -d bugfix git会报错</p><br><p>于是我们可以使用</p><br><p>强行删除&gt;&gt;git branch -<span class="constant">D    (其实就把小写d改为大写D)</span></p><br><p>然后就删除完毕了</p><br><hr><br><p><span style="font-size: 14pt; color: #993366;"> <strong>多人协作</strong></span></p><br><p>真羡慕有两台电脑的人2333</p><br><p>详情去<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013760174128707b935b0be6fc4fc6ace66c4f15618f8d000" target="_blank" rel="external">click me</a> 这个网站观看~</p><br><hr><br><p>&nbsp;</p></blockquote>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-104ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/104ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/104ver/">手机屏幕分辨率和浏览器分辨率</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>转自<a href="http://hc24.iteye.com/blog/1870458" target="_blank" rel="external">http://hc24.iteye.com/blog/1870458</a></p><br><p>在使用CSS3的中有如下类似代码</p><br><div id="" class="dp-highlighter"><br><div class="bar"><br><div class="tools">Html代码 <embed src="http://hc24.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" type="application/x-shockwave-flash" width="14" height="15"> <a title="收藏这段代码"><img class="star" src="http://hc24.iteye.com/images/icon_star.png" data-original="http://hc24.iteye.com/images/icon_star.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="收藏代码"></a></div><br></div><br><ol class="dp-xml" start="1"><br><li>@media screen and (max-width:480px)｛</li><br><li>    ……</li><br><li>｝</li><br></ol><br></div><br><p>&nbsp;</p><br><p>意思是在最大宽度为480px的设备上应用{}里面的样式。这里的width，注意是手机浏览器的分辨率，而不是手机设备的屏幕分辨率。比如苹果4的手机屏幕分辨率是960x640。而其自带的Safari浏览器的分辨率是320<em>480。我们可以通过如下代码检测所用的浏览器的分辨率：</em></p><br><div id="" class="dp-highlighter"><br><div class="bar"><br><div class="tools">Js代码 <embed src="http://hc24.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" type="application/x-shockwave-flash" width="14" height="15"> <a title="收藏这段代码"><img class="star" src="http://hc24.iteye.com/images/icon_star.png" data-original="http://hc24.iteye.com/images/icon_star.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="收藏代码"></a></div><br></div><br><ol class="dp-c" start="1"><br><li>$(<span class="string">“#info”</span>).html(<span class="string">“(您的浏览器的分辨率为：”</span>+($(document).width()+<span class="string">““</span>+$(document).height())+<span class="string">“)”</span>);</li><br></ol><br></div><br><div id="" class="dp-highlighter"><br><div class="bar"><br><div class="tools">Html代码 <embed src="http://hc24.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" type="application/x-shockwave-flash" width="14" height="15"> <a title="收藏这段代码"><img class="star" src="http://hc24.iteye.com/images/icon_star.png" data-original="http://hc24.iteye.com/images/icon_star.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="收藏代码"></a></div><br></div><br><ol class="dp-xml" start="1"><br><li><span class="tag">&lt;</span><span class="tag-name">div</span> <span class="attribute">id</span>=<span class="attribute-value">“info”</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">div</span><span class="tag">&gt;</span></li><br></ol><br></div><br><p>在很多的Android设备上，系统自带的浏览器，chrome浏览器，QQ浏览器，UC等，经过测试得出的值都不太一样。这就给手机WEB开发带来了复杂度。同样在桌面浏览器中测试也会不同。</p><br><p>我们在针对手机进行WEB开发时，通常会在head中加入：</p><br><div id="" class="dp-highlighter"><br><div class="bar"><br><div class="tools">Html代码 <embed src="http://hc24.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" type="application/x-shockwave-flash" width="14" height="15"> <a title="收藏这段代码"><img class="star" src="http://hc24.iteye.com/images/icon_star.png" data-original="http://hc24.iteye.com/images/icon_star.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="收藏代码"></a></div><br></div><br><ol class="dp-xml" start="1"><br><li><span class="tag">&lt;</span><span class="tag-name">meta</span> <span class="attribute">name</span>=<span class="attribute-value">“viewport”</span> <span class="attribute">content</span>=<span class="attribute-value">“width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0”</span><span class="tag">&gt;</span></li><br></ol><br></div><br><p>这里的device-width也是值所使用的浏览器的width，而非手机本身。</p><br><p>&nbsp;</p><br><p>有不当还请指教。</p><br><p>&nbsp;</p><br><p>======================分割线===========================</p><br><p>有用的JS检测代码：</p><br><div id="" class="dp-highlighter"><br><div class="bar"><br><div class="tools">Js代码 <embed src="http://hc24.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" type="application/x-shockwave-flash" width="14" height="15"> <a title="收藏这段代码"><img class="star" src="http://hc24.iteye.com/images/icon_star.png" data-original="http://hc24.iteye.com/images/icon_star.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="收藏代码"></a></div><br></div><br><ol class="dp-c" start="1"><br><li><span class="comment">/<em></em></span></li><br><li><span class="comment">            </span></li><br><li><span class="comment">  智能机浏览器版本信息:</span></li><br><li><span class="comment">            </span></li><br><li><span class="comment"> <em></em></span></li><br><li><span class="comment">            </span></li><br><li><span class="comment"> /</span></li><br><li></li><br><li><span class="keyword">var</span> browser = {</li><br><li></li><br><li>    versions : <span class="keyword">function</span>() {</li><br><li></li><br><li>        <span class="keyword">var</span> u = navigator.userAgent, app = navigator.appVersion;</li><br><li></li><br><li>        <span class="keyword">return</span> {<span class="comment">//移动终端浏览器版本信息 </span></li><br><li></li><br><li>        trident : u.indexOf(<span class="string">‘Trident’</span>) &gt; -1, <span class="comment">//IE内核</span></li><br><li></li><br><li>        presto : u.indexOf(<span class="string">‘Presto’</span>) &gt; -1, <span class="comment">//opera内核</span></li><br><li></li><br><li>        webKit : u.indexOf(<span class="string">‘AppleWebKit’</span>) &gt; -1, <span class="comment">//苹果、谷歌内核</span></li><br><li></li><br><li>        gecko : u.indexOf(<span class="string">‘Gecko’</span>) &gt; -1 &amp;&amp; u.indexOf(<span class="string">‘KHTML’</span>) == -1, <span class="comment">//火狐内核</span></li><br><li></li><br><li>        mobile : !!u.match(/AppleWebKit.<em>Mobile.</em>/) || !!u.match(/AppleWebKit/), <span class="comment">//是否为移动终端</span></li><br><li></li><br><li>        ios : !!u.match(/(i[^;]+;( U;)? CPU.+Mac OS X)/), <span class="comment">//ios终端</span></li><br><li></li><br><li>        android : u.indexOf(<span class="string">‘Android’</span>) &gt; -1 || u.indexOf(<span class="string">‘Linux’</span>) &gt; -1, <span class="comment">//android终端或者uc浏览器</span></li><br><li></li><br><li>        iPhone : u.indexOf(<span class="string">‘iPhone’</span>) &gt; -1 || u.indexOf(<span class="string">‘Mac’</span>) &gt; -1, <span class="comment">//是否为iPhone或者QQHD浏览器</span></li><br><li></li><br><li>        iPad : u.indexOf(<span class="string">‘iPad’</span>) &gt; -1, <span class="comment">//是否iPad</span></li><br><li></li><br><li>        webApp : u.indexOf(<span class="string">‘Safari’</span>) == -1</li><br><li>    <span class="comment">//是否web应该程序，没有头部与底部</span></li><br><li></li><br><li>    };</li><br><li></li><br><li>}(),</li><br><li></li><br><li>language : (navigator.browserLanguage || navigator.language).toLowerCase()</li><br><li></li><br><li>}</li><br></ol><br></div><br><p>&nbsp;</p>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-105ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/105ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/105ver/">简化CSS布局元素宽度计算问题 ： box-sizing属性</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文转自:<a href="http://www.gbtags.com/gb/gbtutorials/60.htm" target="_blank" rel="external">http://www.gbtags.com/gb/gbtutorials/60.htm</a></p><br><p>由于盒模式的宽度计算过于麻烦，特别是对于复杂的布局元素中的处理，现代浏览器引入了box-sizing这个属性，使用并且设置这个属性后，我们只需要设定宽度，浏览器会帮助我们自动计算对应的内容宽度，如下：</p><br><ol class="linenums"><br><li class="L0"><span class="pln">div</span><span class="pun">{</span></li><br><li class="L1"><span class="pln"> margin</span><span class="pun">:</span> <span class="lit">20px</span> <span class="kwd">auto</span><span class="pun">;</span></li><br><li class="L2"></li><br><li class="L3"><span class="com">/<em> 为了更加简单的处理元素的宽度问题这里我们可以使用box-sizing</em>/</span></li><br><li class="L4"><span class="pln"> box</span><span class="pun">-</span><span class="pln">sizing</span><span class="pun">:</span><span class="pln"> border</span><span class="pun">-</span><span class="pln">box</span><span class="pun">;</span></li><br><li class="L5"></li><br><li class="L6"><span class="com">/<em> 为了保证更多浏览器兼容性，我们添加如下前缀</em>/</span></li><br><li class="L7"><span class="pun">-</span><span class="pln">webkit</span><span class="pun">-</span><span class="pln">box</span><span class="pun">-</span><span class="pln">sizing</span><span class="pun">:</span><span class="pln"> border</span><span class="pun">-</span><span class="pln">box</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">-</span><span class="pln">moz</span><span class="pun">-</span><span class="pln">box</span><span class="pun">-</span><span class="pln">sizing</span><span class="pun">:</span><span class="pln"> border</span><span class="pun">-</span><span class="pln">box</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br></ol><br><p>使用以上css定义后，我们只需要指定div的宽度，所有页面的元素无论是否有边框（border），或者有内外边距(padding,margin)，都会保证宽度为我们指定的宽度。如下：</p><br><p>&nbsp;</p><br><p><code>box-sizing</code> 是个比较新的CSS属性，目前还需要使用 <code>-webkit-</code> 和 <code>-moz-</code> 这类浏览器前缀，以便确保其它版本的浏览器能够更好兼容。同时请记住box-sizing支持<a href="http://caniuse.com/#search=box-sizing" target="_blank" rel="external">IE8+</a>。</p><br><p>&nbsp;</p>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-106ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/106ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/106ver/">深入理解Javascript之this关键字</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>转自<a href="http://www.laruence.com/2009/09/08/1076.html" target="_blank" rel="external">http://www.laruence.com/2009/09/08/1076.html</a></p><br><h1>08 Sep 09 <a title="Permanent Link to 深入理解Javascript之this关键字" href="http://www.laruence.com/2009/09/08/1076.html" rel="external" target="_blank">深入理解Javascript之this关键字</a></h1><br><div class="copyright"><br><ul><br><li>作者: <a href="http://www.laruence.com/" target="_blank" rel="external">Laruence</a>(<a title="Twitter" href="http://www.twitter.com/laruence" target="meme"><img src="http://www.laruence.com/images/ico-twitter.png" data-original="http://www.laruence.com/images/ico-twitter.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt=""></a> <a title="新浪微博" href="http://t.sina.com/laruence" target="meme"><img src="http://www.laruence.com/images/ico-sina.png" data-original="http://www.laruence.com/images/ico-sina.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt=""></a> <a title="Google阅读器" href="http://fusion.google.com/add?feedurl=http://www.laruence.com/feed" target="meme"><img src="http://www.laruence.com/images/ico-google.png" data-original="http://www.laruence.com/images/ico-google.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt=""></a> <a title="邮件" href="mailto:laruence@yahoo.com.cn" target="meme"><img src="http://www.laruence.com/images/ico-mail.png" data-original="http://www.laruence.com/images/ico-mail.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt=""></a>)</li><br><li>本文地址: <a title="Permanet Link to 深入理解Javascript之this关键字" href="http://www.laruence.com/2009/09/08/1076.html" target="_blank" rel="external">http://www.laruence.com/2009/09/08/1076.html</a></li><br><li>转载请注明出处</li><br></ul><br></div><br><p>Javascript是一种很灵活的语言, 而This关键字又是灵活中的灵活, 但是因为它的灵活, 也注定了它的难用.</p><br><p>以前我用this的时候, 都会觉得不踏实, 老是担心它不知道怎么地就会指到另外的什么地方.</p><br><p>其实, 这都是因为, 我们对它的不了解.</p><br><p>刚好最近再给百度学院做《Javascript高级-作用域/原型链》的ppt, 而swit1983网友也刚好提这个问题, 索性就把这部分内容独立总结出来, 与大家分享.</p><br><p>首先, 我先抛出一个定论:”在Javascript中,This关键字永远都指向函数(方法)的所有者”.</p><br><h3>函数</h3><br><p>首先,让我们看看”函数”:</p><br><ol><br><li><span class="sh_keyword">function</span> <span class="sh_function">introduce</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><br><li>     <span class="sh_function">alert</span><span class="sh_symbol">(</span><span class="sh_string">“Hello, I am Laruence</span><span class="sh_specialchar">\r\n</span><span class="sh_string">“</span><span class="sh_symbol">);</span></li><br><li><span class="sh_cbracket">}</span></li><br></ol><br><p>对于,这个函数, this关键字指向谁呢?</p><br><p>如我之前的文章所述(<a href="http://www.laruence.com/2009/05/28/863.html" target="_blank">Javascript作用域</a>), 定义在全局的函数, 函数的所有者就是当前页面, 也就是window对象.</p><br><p>这也就是为什么, 我把函数用引号引起来. 因为定义在全局的函数, 其实也就是window对象的一个方法.</p><br><p>所以,我们即可用通过函数名直接调用, 也可用通过window.方法名来调用, 这个时候, 方法中的this关键字指向它的所有者:window对象.</p><br><p>如果, 我们查看window的introduce属性, 就会得到:</p><br><ol><br><li><span class="sh_keyword">var</span> name <span class="sh_symbol">=</span> <span class="sh_string">“I am Laruence”</span><span class="sh_symbol">;</span></li><br><li><span class="sh_keyword">function</span> <span class="sh_function">introduce</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><br><li>     <span class="sh_function">alert</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>name<span class="sh_symbol">);</span></li><br><li><span class="sh_cbracket">}</span></li><br><li><span class="sh_function">alert</span><span class="sh_symbol">(</span>window<span class="sh_symbol">.</span>introduce<span class="sh_symbol">);</span></li><br><li><span class="sh_comment">/<strong></strong></span></li><br><li><span class="sh_comment"><em> output:</em></span></li><br><li><span class="sh_comment"> function introduce() {</span></li><br><li><span class="sh_comment"><em> alert(this.name);</em></span></li><br><li><span class="sh_comment"> }</span></li><br><li><span class="sh_comment">*/</span></li><br></ol><br><p>看了上面的代码, 也许你就会想到既然, 全局函数是window对象的方法, 全局变量是window对象的属性(Javasript作用域中已有述及), 那么,在全局函数中就可用通过this关键字来访问全局变量吧?</p><br><p>答案是肯定的, 如果调用introduce函数, 你就会认识我是Laruence.</p><br><h3>事件处理函数</h3><br><p>也许, 对于this关键字的迷惑, 绝大部分原因是来自把函数(方法)用在事件处理的时候.</p><br><ol><br><li><span class="sh_keyword">&lt;input</span> <span class="sh_type">id</span><span class="sh_symbol">=</span><span class="sh_string">“name”</span> <span class="sh_type">type</span><span class="sh_symbol">=</span><span class="sh_string">“text”</span> <span class="sh_type">name</span><span class="sh_symbol">=</span><span class="sh_string">“name”</span> <span class="sh_type">value</span><span class="sh_symbol">=</span><span class="sh_string">“Laruence”</span> <span class="sh_keyword">/&gt;</span></li><br></ol><br><p>比如, 我们现在需要在点击”name”输入框的时候, 显示出name输入框的value. 那么, 可用写下如下代码:</p><br><ol><br><li><span class="sh_keyword">function</span> <span class="sh_function">showValue</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><br><li>     <span class="sh_function">alert</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>value<span class="sh_symbol">);</span></li><br><li><span class="sh_cbracket">}</span></li><br><li>document<span class="sh_symbol">.</span><span class="sh_function">getElementById</span><span class="sh_symbol">(</span><span class="sh_string">‘name’</span><span class="sh_symbol">).</span>onclick <span class="sh_symbol">=</span> showValue<span class="sh_symbol">;</span></li><br></ol><br><p>上面的代码, 运行正常, 但是why? 不是说函数的this指针永远指向函数所有者么? 不是说全局变量的所有者是window对象么?</p><br><p>呵呵, 如果你能想到这个问题, 那说明你在认真的看我的文章, 否则,,我建议你从头看起, 否则看完了,你还是迷糊~</p><br><p>恩, 对, 对于上面的代码, showValue是定义在了全局对象, 那么看来问题只能发生在onclick事件绑定的时候了.</p><br><p>我们知道, 在Js中一切都是对象, 函数和方法也都是对象的属性, 只不过函数有可执行的内部属性. 所以, 对于上面的代码, 在对onclick绑定处理器的时候, 其实是对id为name的输入框Dom对象的onclick属性赋值.</p><br><p>也就是说, 我们把函数showValue Copy 给了name输入框对象的onclick属性. 如果我们查看此时的onclick:</p><br><ol><br><li><span class="sh_keyword">function</span> <span class="sh_function">showValue</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><br><li>     <span class="sh_function">alert</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>value<span class="sh_symbol">);</span></li><br><li><span class="sh_cbracket">}</span></li><br><li>document<span class="sh_symbol">.</span><span class="sh_function">getElementById</span><span class="sh_symbol">(</span><span class="sh_string">‘name’</span><span class="sh_symbol">).</span>onclick <span class="sh_symbol">=</span> showValue<span class="sh_symbol">;</span></li><br><li><span class="sh_function">alert</span><span class="sh_symbol">(</span>document<span class="sh_symbol">.</span><span class="sh_function">getElementById</span><span class="sh_symbol">(</span><span class="sh_string">‘name’</span><span class="sh_symbol">).</span>onclick<span class="sh_symbol">);</span></li><br><li><span class="sh_comment">/</span></li><br><li><span class="sh_comment"><em> output</em></span></li><br><li><span class="sh_comment"> function showValue() {</span></li><br><li><span class="sh_comment"><em> alert(this.value);</em></span></li><br><li><span class="sh_comment"> }</span></li><br><li><span class="sh_comment"><em>/</em></span></li><br></ol><br><p>所以, 当事件触发的时候, 就会去调用name输入框的onclick方法, 这个时候,this关键字自然就指向的是name输入框了.</p><br><p>但是, 迷惑的事情就来了, 比如下面这种写法:</p><br><ol><br><li><span class="sh_keyword">function</span> <span class="sh_function">showValue</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><br><li>     <span class="sh_function">alert</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>value<span class="sh_symbol">);</span></li><br><li><span class="sh_cbracket">}</span></li><br><li><span class="sh_symbol">&lt;</span>input id<span class="sh_symbol">=</span><span class="sh_string">“name”</span> type<span class="sh_symbol">=</span><span class="sh_string">“text”</span> name<span class="sh_symbol">=</span><span class="sh_string">“name”</span> value<span class="sh_symbol">=</span><span class="sh_string">“Laruence”</span> onclick<span class="sh_symbol">=</span><span class="sh_string">“showValue()”</span><span class="sh_symbol">/&gt;</span></li><br></ol><br><p>就无法正常运行, 这又是为什么呢?</p><br><p>恩, 因为这个时候, 并不是赋值, 而是引用.</p><br><p>如果我们注意俩种onclick的写法, 你会发现, 对于之前的方法, 我们使用的是:</p><br><ol><br><li>dom<span class="sh_symbol">.</span>onclick <span class="sh_symbol">=</span> showvalue<span class="sh_symbol">;</span> <span class="sh_comment">//没有调用符</span></li><br></ol><br><p>而对于刚才的方法:</p><br><ol><br><li>onclick <span class="sh_symbol">=</span> <span class="sh_string">“showvalue()”</span> <span class="sh_comment">//有调用符</span></li><br></ol><br><p>这个也能侧面的反映出俩者的区别:对于前者,是赋值, 而对于后者是引用. 如果我们这个时候查看输入框的onclick属性,我们得到:</p><br><ol><br><li><span class="sh_function">alert</span><span class="sh_symbol">(</span>dom<span class="sh_symbol">.</span>onclick<span class="sh_symbol">);</span></li><br><li><span class="sh_comment">/**</span></li><br><li><span class="sh_comment"> output:</span></li><br><li><span class="sh_comment"><em> function onclick() {</em></span></li><br><li><span class="sh_comment"> showValue();</span></li><br><li><span class="sh_comment"><em> }</em></span></li><br><li><span class="sh_comment">/</span></li><br></ol><br><p>看到区别了么? 也就懂得为什么了吧?</p><br><p>讲到这里, 有一个很有趣的例子 ,大家可以在IE下试试:</p><br><ol><br><li><span class="sh_symbol">&lt;</span>img src<span class="sh_symbol">=</span><span class="sh_string">“xxx”</span> onerror<span class="sh_symbol">=</span><span class="sh_string">“alert(1);} function hi() { alert(2); “</span> <span class="sh_symbol">/&gt;</span></li><br></ol><br><h3>改变this的指向</h3><br><p>那, 既然我们已经知道为什么了, 那怎么才能让this指向我们想要指的地方呢?</p><br><p>对于上面的事件处理函数来说, 我们可以有如下几种写法:</p><br><ol><br><li>dom<span class="sh_symbol">.</span>onclick <span class="sh_symbol">=</span> <span class="sh_function">showValue</span><span class="sh_symbol">();</span></li><br><li>dom<span class="sh_symbol">.</span>onclick <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span> <span class="sh_function">alert</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>value<span class="sh_symbol">)</span> <span class="sh_symbol">;</span><span class="sh_cbracket">}</span></li><br><li><span class="sh_symbol">&lt;</span>input onclick<span class="sh_symbol">=</span><span class="sh_string">“alert(this.value);”</span> <span class="sh_regexp">/&gt; /</span><span class="sh_symbol">/</span>想想刚才我们的引用<span class="sh_symbol">,</span>是如何把这句嵌入的<span class="sh_symbol">.</span></li><br><li>dom<span class="sh_symbol">.</span><span class="sh_function">addEventListener</span><span class="sh_symbol">(</span>dom<span class="sh_symbol">,</span> showValue<span class="sh_symbol">,</span> <span class="sh_keyword">false</span><span class="sh_symbol">);</span> <span class="sh_comment">//ff only</span></li><br></ol><br><p>而对于不是事件处理函数的场合, 我们可以使用apply, 或者call, 来改变this关键字的指向.</p><br><p>比如:</p><br><ol><br><li><span class="sh_keyword">var</span> laruence <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span></li><br><li>     name <span class="sh_symbol">:</span> <span class="sh_string">‘laruence’</span><span class="sh_symbol">,</span></li><br><li>     age <span class="sh_symbol">:</span> <span class="sh_number">26</span><span class="sh_symbol">,</span></li><br><li>     position <span class="sh_symbol">:</span> <span class="sh_string">‘Senior PHP Engineer’</span><span class="sh_symbol">,</span></li><br><li>     company <span class="sh_symbol">:</span> <span class="sh_string">‘Baidu.inc’</span></li><br><li><span class="sh_cbracket">}</span><span class="sh_symbol">;</span></li><br><li></li><br><li><span class="sh_keyword">function</span> <span class="sh_function">introduce</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><br><li>     <span class="sh_function">alert</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>name<span class="sh_symbol">);</span></li><br><li><span class="sh_cbracket">}</span></li><br><li></li><br><li>introduce<span class="sh_symbol">.</span><span class="sh_function">call</span><span class="sh_symbol">(</span>laruence<span class="sh_symbol">);</span></li><br></ol><br><p>&nbsp;</p><br><p>&nbsp;</p>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-107ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/107ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/107ver/">干货！一步步实现自己的表单验证器</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p></p><p>转自<a href="http://www.gbtags.com/gb/share/5017.htm" target="_blank" rel="external">http://www.gbtags.com/gb/share/5017.htm</a></p><p></p>
<p></p><p>表单验证的需求简直太常见了。“<strong>所有用户的输入都是不可信的</strong>”这个思想指导我们在设计表单的时候，一定要进行用户输入的验证。对于用户体验而言，越早的反馈则越佳，所以表单验证的工作应该尽可能地在前端就进行（当然，前端对于后端而言也是输入端，所以后端仍然需要进行检验）。简单的表单验证完全可以给input绑定几个change事件来进行。但表单一复杂，或者相似验证规则一多，这种编码的方式就很难管理事件了。这时候，我们通常需要使用一些库来帮助我们处理表单验证的工作。前端表单验证的库太多了，随便一搜：<a href="http://www.zhouhua.info/jump/z000" target="_blank">表单验证-百度搜索</a>。</p><p></p>
<p></p><p>那……为什么还要自己实现一个呢？因为去年工作中遇到了比较复杂的验证逻辑，选一个别人的库一是要学习api，二是维护起来困难，要符合自己的页面风格也不是那么轻松；再加上表单验证器并不复杂，于是就打算自己写一个。所以这个表单验证器并不算那么地通用，不过我觉得传播思路和方法更重要，要想修修改改变成一个通用的库也很容易，只是没那么重要罢了（其实是懒……）。</p><p></p>
<p></p><h2>依赖</h2><p></p>
<p></p><p>jquery + bootstrap。jquery看来是缺不了，bootstrap没那么重要，对代码稍做修改就可以取消依赖。</p><p></p>
<p></p><h2>能做什么</h2><p></p>
<p></p><p>我期望这个表单验证器直接在html代码中指定好需要采用什么样的规则，不需要用javascript进行多余的配置；允许暂时跳过验证；允许扩展验证规则；提供验证难过、验证失败、警告三种验证结果；允许手动触发验证等等。</p><p></p>
<p></p><p>一个典型的bootstrap风格的表单项应该长这个样子：</p><p></p>
<p><div class="jspContainer"></div></p>
<p><div class="jspPane"></div></p>
<p><ol class="linenums"></ol></p>
<p><li class="L0"><span class="tag">&lt;div</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“form-group”</span><span class="tag">&gt;</span></li></p>
<p><li class="L1"><span class="tag">&lt;label</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“col-xs-2 control-label”</span><span class="tag">&gt;</span><span class="pln">手机号码</span></li></p>
<p><li class="L2"><span class="tag">&lt;span</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“request”</span><span class="tag">&gt;</span><span class="pln">*</span><span class="tag">&lt;/span&gt;</span><span class="pln">：</span><span class="tag">&lt;/label&gt;</span></li></p>
<p><li class="L3"><span class="tag">&lt;div</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“col-xs-6”</span><span class="tag">&gt;</span></li></p>
<p><li class="L4"><span class="tag">&lt;input</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“form-control”</span> <span class="atn">name</span><span class="pun">=</span><span class="atv">“mobile”</span> <span class="atn">type</span><span class="pun">=</span><span class="atv">“text”</span> <span class="atn">data-validate-disable</span><span class="pun">=</span><span class="atv">“true”</span> <span class="atn">data-validate</span><span class="pun">=</span><span class="atv">“request:notrim mobile”</span> <span class="tag">/&gt;</span></li></p>
<p><li class="L5"><span class="tag">&lt;p</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“text-info”</span><span class="tag">&gt;</span><span class="pln">请输入真实手机号码。</span><span class="tag">&lt;/p&gt;</span></li></p>
<p><li class="L6"><span class="tag">&lt;/div&gt;</span></li></p>
<p><li class="L7"><span class="tag">&lt;div</span> <span class="atn">class</span><span class="pun">=</span><span class="atv">“help-block col-xs-4”</span><span class="tag">&gt;</span><span class="pln">&amp;nbsp;</span><span class="tag">&lt;/div&gt;</span></li></p>
<p><li class="L8"><span class="tag">&lt;/div&gt;</span></li><br><br></p>
<p><div class="jspVerticalBar"></div></p>
<p><div class="jspHorizontalBar"></div><br></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><p>重点看第5行，对于一个普通的input组件，我加了两个属性， data-validate-disable 有值表示表单验证时，会跳过这个input组件； data-validate 则存放如果要验证的话，将采用什么样的验证规则。这个例子中表示要验证这个input组件是否为空、是否为手机号码这两个规则。注意，在request 的后面我还加了一点内容，这是我想传递给验证规则的参数，比如这里我期望告诉验证器，如果input值只有空格，也认为是有值的。相似的，我们可以定义一个规则 min 来处理最少几个字符，并在html中把这个设定值传递进来，就像这样： data-validate=”min:10” 。我也期望一个验证规则允许多个参数传递，参数与参数之间用逗号隔开。</p><p></p>
<p></p><p>看起来很有意思，那就开始动手吧。</p><p></p>
<p></p><h2>先写个jquery插件吧</h2><p></p>
<p><div class="jspContainer"></div></p>
<p><div class="jspPane"></div></p>
<p><ol class="linenums"></ol></p>
<p><li class="L0"><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">)</span> <span class="pun">{</span></li></p>
<p><li class="L1"><span class="pln"> $</span><span class="pun">.</span><span class="pln">fn</span><span class="pun">.</span><span class="pln">validation </span><span class="pun">=</span> <span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li></p>
<p><li class="L2"><span class="kwd">return</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">each</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li></p>
<p><li class="L3"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li></p>
<p><li class="L4"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">))</span> <span class="pun">{</span></li></p>
<p><li class="L5"><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">);</span></li></p>
<p><li class="L6"><span class="pun">}</span></li></p>
<p><li class="L7"><span class="pln"> $this</span><span class="pun">.</span><span class="pln">off</span><span class="pun">(</span><span class="str">‘blur.zh select.zh focus.zh’</span><span class="pun">)</span></li></p>
<p><li class="L8"><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">‘blur.zh select.zh’</span><span class="pun">,</span><span class="pln"> validate</span><span class="pun">)</span></li></p>
<p><li class="L9"><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">‘focus.zh’</span><span class="pun">,</span><span class="pln"> clear</span><span class="pun">);</span></li></p>
<p><li class="L0"><span class="pun">});</span></li></p>
<p><li class="L1"><span class="pun">};</span></li></p>
<p><li class="L2"><span class="pun">}(</span><span class="pln">jQuery</span><span class="pun">));</span></li><br><br></p>
<p><div class="jspVerticalBar"></div><br></p>
<p></p><p>给jquery对象添加一个 validation 方法，用法很简单： $(Selector).validation() 。支持链式调用。<em>Selector</em>比较自由，如果是 :input 元素，则直接给这些元素初始化验证器；否则找出它们所有的 :input 子元素，给这些子元素初始化验证器。什么意思呢？就以上面的html片断为例，你可以任性地使用如下任意一种方式初始化验证器：</p><p></p>
<p><ul></ul></p>
<p><li>$(‘[name=mobile]’).validation(); // 选择:input</li></p>
<p><li>$(‘.form-group’).validation(); // 选择普通节点，对所有:input子元素生效</li></p>
<p><li>$(‘body’).validation(); // 对页面中所有的:input元素生效</li><br></p>
<p></p><p>再说说所谓的初始化，其实就是绑定事件。那么要绑定什么事件呢？主观上，对于一个输入框，当我们输入好了，焦点离开时，应该就进行输入内容的验证，并给出验证结果。如果验证失败，会有提示信息，但这些提示信息应该在重新获得焦点时清除，否则当用户在修正输入的时候还一直提示上次的错误信息，会让用户无所适从。那么针对以上的情况，我们需要在失去焦点（<em>blur</em>）和获得焦点（<em>focus</em>）时分别绑定验证的方法（<em>validate</em>）和清除错误信息的方法（<em>clear</em>）。另外针对checkbox、radiobox、select等控件，最好也给select事件绑定验证方法。</p><p></p>
<blockquote><p>为什么不使用更通用change事件来绑定验证方法呢？原因有二：</p><br><ol><br><li>我觉得有些场景需要用javascript载入默认值或历史输入。这些内容应该延后验证（不是不验证），不然刚打开页面就是表单验证错误让人很难受。所以change事件不合适。</li><br><li>由于获得焦点会清空错误消息，如果没有修改内容，直接失去焦点，这时不会触发change事件，导致不会再验证，表现为错误信息丢失。</li><br></ol><br></blockquote><br><p>那下面就来具体看看<em>validate</em>和<em>clear</em>两个方法。</p><br><h2>清除错误消息及验证状态设置</h2><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="kwd">function</span><span class="pln"> clear</span><span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$parent</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">)</span> <span class="pun">||</span></li><br><li class="L4"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">)</span> <span class="pun">===</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">prop</span><span class="pun">(</span><span class="str">‘name’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">,</span> <span class="kwd">null</span><span class="pun">).</span><span class="pln">removeClass</span><span class="pun">(</span><span class="str">‘has-error waiting has-warning’</span><span class="pun">)</span></li><br><li class="L6"><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘.help-block’</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="str">‘’</span><span class="pun">);</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"></li><br><li class="L0"><span class="kwd">function</span><span class="pln"> successHandler</span><span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$parent</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘.has-warning’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> clear</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"></li><br><li class="L7"><span class="kwd">function</span><span class="pln"> failHandler</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L9"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">removeClass</span><span class="pun">(</span><span class="str">‘has-warning waiting’</span><span class="pun">).</span><span class="pln">addClass</span><span class="pun">(</span><span class="str">‘has-error’</span><span class="pun">).</span></li><br><li class="L0"><span class="pln"> attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">,</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">prop</span><span class="pun">(</span><span class="str">‘name’</span><span class="pun">)).</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘.help-block’</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">);</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"></li><br><li class="L3"><span class="kwd">function</span><span class="pln"> warningHandler</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L5"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">removeClass</span><span class="pun">(</span><span class="str">‘waiting’</span><span class="pun">).</span><span class="pln">addClass</span><span class="pun">(</span><span class="str">‘has-warning’</span><span class="pun">).</span></li><br><li class="L6"><span class="pln"> attr</span><span class="pun">(</span><span class="str">‘data-for’</span><span class="pun">,</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">prop</span><span class="pun">(</span><span class="str">‘name’</span><span class="pun">)).</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘.help-block’</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">);</span></li><br><li class="L7"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><h2> 这一段一起说，因为这部分内容是dom操作相关的，与bootstrap强相关，如果你不用bootstrap，那就尽情地替换掉吧（估计改几个类名就行了）。这几个函数的用途从名字上就可以看出。clear上面已经提到过，清空验证信息；另外三个分别处理验证通过、验证失败和警告时的信息展示。简单是简单，但这里有两个问题需要额外考虑一下。</h2><br><p>第一个是验证信息优先级的问题：</p><br><p>一个输入项可能同时有多个验证规则要匹配，可能有些验证规则通过，有些失败，有些警告。在具体处理时，我觉得比较合理的流程是：如果出现验证失败，则立刻停止后续验证，直接提示错误信息；如果警告，则提示警告信息，并继续后续规则验证；如果验证成功，理论上不需要做任何处理，直接进行下一步验证，但谨慎起见，还是做一下清空错误信息的工作，但要注意不可以清空掉警告信息（错误信息不用管，因为一产生错误信息，验证也就停止了，不会再触发验证成功了）。</p><br><p>另一个问题是同一个表单单元中有多个输入控件的问题，就像这样：</p><br><p><img src="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415121912.png" data-original="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415121912.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="QQ20150415121912" width="586" height="96"></p><br><p>几个控件共用了一个错误信息展示文本，我觉得如果某一个控件输入内容有误，必须再次修改这个控件内容才能清空错误信息，修改别的控件时，这个错误信息应该保留。所以在清除错误信息时，我们额外需要知道这个错误信息是由哪个控件引起的。在上面的示例中，我们在处理验证错误和警告时，把引起问题的控件的<em>name</em>记录到表单单元的<em>data-for</em>属性中了。到需要清空的时候再比对一下<em>data-for</em>和当前控件的<em>name</em>是不是一致，不一致就不清空错误信息。</p><br><h2>处理验证流程</h2><br><p>我们给输入控件的<em>blur</em>和<em>select</em>事件绑定了<em>validate</em>方法，那么这个validate方法如何实现呢？</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="kwd">function</span><span class="pln"> validate</span><span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> success </span><span class="pun">=</span> <span class="kwd">new</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Callbacks</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> fail </span><span class="pun">=</span> <span class="kwd">new</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Callbacks</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> warning </span><span class="pun">=</span> <span class="kwd">new</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Callbacks</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">var</span><span class="pln"> $parent </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">closest</span><span class="pun">(</span><span class="str">‘.form-group’</span><span class="pun">);</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">value</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> successHandler</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span></li><br><li class="L8"><span class="pun">});</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">value</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="pln"> failHandler</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span></li><br><li class="L1"><span class="pun">});</span></li><br><li class="L2"><span class="pln"> warning</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">(</span><span class="pln">value</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> warningHandler</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span></li><br><li class="L4"><span class="pun">});</span></li><br><li class="L5"><span class="pln"> clear</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">$this</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘:disabled’</span><span class="pun">)</span> <span class="pun">||</span><span class="pln"> $this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘[data-validate-disable]’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L7"><span class="kwd">return</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$this</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-validate’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> conditions </span><span class="pun">=</span> <span class="pun">(</span><span class="pln">$this</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">‘data-validate’</span><span class="pun">)</span> <span class="pun">||</span> <span class="str">‘’</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">/\s+/</span><span class="pln">g</span><span class="pun">);</span></li><br><li class="L1"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span></li><br><li class="L2"><span class="pln"> conditions</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> condition </span><span class="pun">=</span><span class="pln"> conditions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></li><br><li class="L4"><span class="pln"> $parent</span><span class="pun">.</span><span class="pln">addClass</span><span class="pun">(</span><span class="str">‘waiting’</span><span class="pun">);</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">pickStrategy</span><span class="pun">(</span><span class="pln">condition</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">/[:,]/</span><span class="pln">g</span><span class="pun">),</span><span class="pln"> $this</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">,</span><span class="pln"> warning</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><p>先看这段代码的前一部分，我定义了三个$.Callbacks对象，分别用以处理不同验证结果的响应。从效果上，不用$.Callbacks对象，直接传递函数引用也是可行的，我是想把dom操作和验证逻辑分离开，用类似事件触发的异步形式来处理验证逻辑。</p><br><p>再看第17行，它规定了两种情形不执行验证，一种是控件被禁用，另一种是控件中存在<em>data-validate-disable</em>属性。这个不用多解释了。</p><br><p>重点看20~30行，这段是关键。第21行中，我们把<em>data-validate</em>中的内容按空白（空格、tab、换行）切割到一个数组<em>conditions</em>中，<em>conditions</em>中的每一项都是一条需要验证的规则。那么很自然地，遍历这个数组。再看第26行，引入了一个新的方法<em>pickStrategy</em>，很明显它是对这条规则进行验证。先别管它的实现，看看它接收的参数。还记得前面我们说要允许用 rule:param1,param2 的形式给验证规则传入参数吗？<em>pickStrategy</em>拿到的第一个参数就是 [rule, param1, param2] ，通过condition.spit(/[:,]/g) 解析出。第二个参数是当前处理的控件的jquery对象，后面三个分别是验证成功、失败、警告三种情形的回调对象。如果验证失败，<em>pickStrategy</em>应该返回 false ，同时中止验证，否则验证下一条规则。</p><br><h2>策略模式</h2><br><p>下面就要来说<em>pickStrategy</em>方法了，不过先要补充一点背景知识——策略模式。策略模式是一种设计模式。</p><br><p>设计模式是搞软件工程的人常常挂在嘴边的词汇，表示对设计的复用。当然前端开发在工程化的进程上每家公司情况各异，我估计绝大多数公司的前端开发并不考虑工程上的问题，只考虑完成需求。因而对于没有OO编程开发背景的前端开发而言，设计模式可能是陌生的，甚至程序设计（别紧张，没有在说程序编写）本身就是陌生的。由于工程化的忽略和javascript语言本身的优点（很多模式没必要实现）和缺点（很多模式无法实现），前端开发中很少提设计模式。那么前端开发者怎么理解设计模式呢？设计模式就是一系统问题（场景）的通用解决思路。比如有人觉得jquery的链式调用很好用，能很大程度降低工作量，于是在别的地方也用函数 return this; 的方式构造支持链式调用的函数，这就可以认为是一个模式（谈不上设计模式）。</p><br><p>那策略模式是为了解决什么问题，或应对什么场景的呢？如果干一件事、完成一个任务可以有不同的策略，不同的算法来完成，这些策略、算法应该具有相同的输入和输出，但可以使用不同的资源（即不care中间实现差异）。具体要采用什么策略和方法则在程序运行时依据条件选择。举个例子？</p><br><p><img src="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415155218.png" data-original="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/QQ20150415155218.png" onerror="this.onerror=null;this.src='http://www.old.com/wp-content/themes/BYMT/images/images_error.jpg'" alt="QQ20150415155218" width="470" height="403"></p><br><p>压缩文件，你可以选择不同的算法，但它们拥有相同的输入和输出。</p><br><p>那么我们做表单验证跟策略模式有什么关系呢？我们完全可以把每个验证规则看作是一个策略，我们支持的所有的策略放在一起，取个高大上的名字叫“策略池”。当我们想验证一个规则的时候，只需要去策略池中取出这个策略跑一下，不需要在一个很大的函数里面跑一堆if…else，或者switch…case。另外如果有新的规则加进来，只要把它塞到策略池中，无需更改已有的代码，<strong>实现验证规则和验证流程解耦</strong>。</p><br><p>先实现一个策略池吧：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy </span><span class="pun">=</span> <span class="pun">{};</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>太棒了，一句代码就完事了，爱死javascript了！</p><br><p>再回到<em>pickStrategy</em>方法，看看怎么从这个策略池中拿到我们需要的验证规则：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="kwd">function</span><span class="pln"> pickStrategy</span><span class="pun">(</span><span class="pln">tokens</span><span class="pun">,</span><span class="pln"> scope</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">,</span><span class="pln"> warning</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> tokens</span><span class="pun">.</span><span class="pln">shift</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> strategy </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy</span><span class="pun">[</span><span class="pln">name</span><span class="pun">];</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">strategy</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="kwd">return</span><span class="pln"> strategy</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">scope</span><span class="pun">,</span><span class="pln"> tokens</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">,</span><span class="pln"> warning</span><span class="pun">);</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><p>先说这个<em>token</em>，还记得它是什么吗？如果要验证的规则是“min:5”，那么<em>token</em>就是 [‘min’,’5’] 这个数组。第2行取出这个数组的第一项 ‘min’ ，再从策略池中取出这个验证规则。如果没有这个规则，则跳过这次验证，认为此次通过；如果有这个规则，则执行这个规则（见第5行），需要注意一下第5行的<em>token</em>已经发生变化了，除去规则名称，只剩下参数了，延续前面的例子，这里<em>token</em>应该是 [‘5’] 。</p><br><p>现在我们的策略池是空的，那可不行，先试着写一个验证“min”规则的方法吧：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy</span><span class="pun">.</span><span class="pln">min </span><span class="pun">=</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">()</span> <span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span> <span class="pun">+(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L7"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;=</span><span class="pln"> length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请至少输入’</span> <span class="pun">+</span><span class="pln"> length </span><span class="pun">+</span> <span class="str">‘个字！’</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br></div><br><p>&nbsp;</p><br><p>这个方法内，<em>this</em>指向当前验证的控件的jquery对象，第1个参数是额外带给验证规则的参数；第2个参数是验证成功的回调，使用时需要配合 return true; （见9、10行）；第3个参数是验证失败的回调，使用是需要配合 return false; （见13、14行）；第4个参数是警告的回调，需要配合return true; ，这个验证中没用到。</p><br><p>起始的几个验证方法也可以直接写在策略池中，我写了几个，供大家参考：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants </span><span class="pun">=</span> <span class="pun">{</span></li><br><li class="L1"><span class="str">‘request’</span><span class="pun">:</span> <span class="str">/./</span><span class="pun">,</span></li><br><li class="L2"><span class="str">‘trimLeft’</span><span class="pun">:</span> <span class="str">/^\s+/</span><span class="pun">,</span></li><br><li class="L3"><span class="str">‘trimRight’</span><span class="pun">:</span> <span class="str">/\s+$/</span><span class="pun">,</span></li><br><li class="L4"><span class="str">‘trim’</span><span class="pun">:</span> <span class="str">/(^\s+)|(\s+$)/</span><span class="pln">g</span><span class="pun">,</span></li><br><li class="L5"><span class="str">‘number’</span><span class="pun">:</span> <span class="str">/^-?\d+(,\d{3,4})<em>(.\d+)?$/</em></span><span class="pun">,</span></li><br><li class="L6"><span class="str">‘purenumber’</span><span class="pun">:</span> <span class="str">/^\d+$/</span><span class="pun">,</span></li><br><li class="L7"><span class="str">‘shenfenzheng’</span><span class="pun">:</span> <span class="str">/^\d{17}[\dx]$/</span><span class="pln">i</span><span class="pun">,</span></li><br><li class="L8"><span class="str">‘taibaozheng’</span><span class="pun">:</span> <span class="str">/^\d{8}(\d{2})?$/</span><span class="pun">,</span></li><br><li class="L9"><span class="str">‘zhizhao’</span><span class="pun">:</span> <span class="str">/^\d{15}$/</span><span class="pun">,</span></li><br><li class="L0"><span class="str">‘mobile’</span><span class="pun">:</span> <span class="str">/^1[345789]\d{9}$/</span><span class="pun">,</span></li><br><li class="L1"><span class="str">‘telephone’</span><span class="pun">:</span> <span class="str">/^\d{7,8}([ +-]\d+)?$/</span><span class="pun">,</span></li><br><li class="L2"><span class="str">‘email’</span><span class="pun">:</span> <span class="str">/^[a-z0-9.-<em>+]+@[a-z0-9-</em>]+(.[a-z0-9-<em>]+)+$/</em></span><span class="pln">i</span><span class="pun">,</span></li><br><li class="L3"><span class="str">‘url’</span><span class="pun">:</span> <span class="str">/^(https?:\/\/)?(([\d]{1,3}.){3}[\d]{1,3}|([\d\w!~\‘()-]+.)<em>([\d\w][\d\w-]{0,61})?[\d\w].[\w]{2,6})(:[\d]{1,4})?((\/?)|(\/[\d\w_!~</em>\‘().;?:@&amp;=+$,%#-]+)+\/?)$/</span></li><br><li class="L4"><span class="pun">};</span></li><br><li class="L5"><span class="pln"> </span></li><br><li class="L6"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy </span><span class="pun">=</span> <span class="pun">{</span></li><br><li class="L7"><span class="str">‘request’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">“[type=checkbox]”</span><span class="pun">)</span> <span class="pun">||</span> <span class="kwd">this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">“[type=radio]”</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> name </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">attr</span><span class="pun">(</span><span class="str">“name”</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">name</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">(</span><span class="str">“[name=”</span> <span class="pun">+</span><span class="pln"> name </span><span class="pun">+</span> <span class="str">“]:checked”</span><span class="pun">).</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘不能为空！’</span><span class="pun">);</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L7"><span class="kwd">switch</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">toLowerCase</span><span class="pun">())</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">case</span> <span class="str">‘notrim’</span><span class="pun">:</span></li><br><li class="L9"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L0"><span class="kwd">case</span> <span class="str">‘trimleft’</span><span class="pun">:</span></li><br><li class="L1"><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">trimLeft</span><span class="pun">,</span> <span class="str">‘’</span><span class="pun">));</span></li><br><li class="L2"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L3"><span class="kwd">case</span> <span class="str">‘trimright’</span><span class="pun">:</span></li><br><li class="L4"><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">trimRight</span><span class="pun">,</span> <span class="str">‘’</span><span class="pun">));</span></li><br><li class="L5"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L6"><span class="kwd">default</span><span class="pun">:</span></li><br><li class="L7"><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">trim</span><span class="pun">,</span> <span class="str">‘’</span><span class="pun">));</span></li><br><li class="L8"><span class="kwd">break</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">request</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">()))</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘不能为空！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">},</span></li><br><li class="L9"><span class="str">‘min’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">()</span> <span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span> <span class="pun">+(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;=</span><span class="pln"> length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请至少输入’</span> <span class="pun">+</span><span class="pln"> length </span><span class="pun">+</span> <span class="str">‘个字！’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">},</span></li><br><li class="L0"><span class="str">‘max’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span> <span class="pun">+(</span><span class="pln">condition </span><span class="pun">&amp;&amp;</span><span class="pln"> condition</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&lt;=</span><span class="pln"> length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L8"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘不能超过’</span> <span class="pun">+</span><span class="pln"> length </span><span class="pun">+</span> <span class="str">‘个字！’</span><span class="pun">);</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pun">},</span></li><br><li class="L7"><span class="str">‘number’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">}</span></li><br><li class="L3"><span class="pln"> condition </span><span class="pun">=</span><span class="pln"> condition </span><span class="pun">||</span> <span class="pun">[];</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">number</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入数字！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span></li><br><li class="L9"><span class="pln"> condition</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> condition</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">toLowerCase</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">c </span><span class="pun">===</span> <span class="str">‘pure’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">purenumber</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入0~9组成的数字！’</span><span class="pun">);</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="kwd">else</span> <span class="kwd">if</span> <span class="pun">(</span><span class="str">/^\d+[~-]\d+$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">c</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L8"><span class="kwd">var</span><span class="pln"> match </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="str">/\d+/</span><span class="pln">g</span><span class="pun">);</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> length </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length </span><span class="pun">&lt;</span> <span class="pun">+</span><span class="pln">match</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请至少输入’</span> <span class="pun">+</span><span class="pln"> match</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span> <span class="pun">+</span> <span class="str">‘位数字！’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">length </span><span class="pun">&gt;</span> <span class="pun">+</span><span class="pln">match</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘最多只能输入’</span> <span class="pun">+</span><span class="pln"> match</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span> <span class="pun">+</span> <span class="str">‘位数字！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">else</span> <span class="kwd">if</span> <span class="pun">(</span><span class="str">/^\d+$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">c</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(+</span><span class="pln">c </span><span class="pun">!==</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">length</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入’</span> <span class="pun">+</span><span class="pln"> c </span><span class="pun">+</span> <span class="str">‘位数字！’</span><span class="pun">);</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pun">},</span></li><br><li class="L9"><span class="str">‘mobile’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">mobile</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘手机号码输入有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">},</span></li><br><li class="L2"><span class="str">‘url’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">url</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">()))</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入正确的网址！如<a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a>‘</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">},</span></li><br><li class="L5"><span class="str">‘email’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L6"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L8"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">email</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L2"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘电子邮箱格式错误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">},</span></li><br><li class="L8"><span class="str">‘telephone’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L0"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">telephone</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘电话号码输入有误，请检查后重新输入！！’</span><span class="pun">);</span></li><br><li class="L6"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L9"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">},</span></li><br><li class="L1"><span class="str">‘shenfenzheng’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="pln"> value </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">();</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">shenfenzheng</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L9"><span class="kwd">var</span><span class="pln"> numbers </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">().</span><span class="pln">split</span><span class="pun">(</span><span class="str">‘’</span><span class="pun">);</span></li><br><li class="L0"><span class="com">// 验证地区</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> aCity </span><span class="pun">=</span> <span class="pun">{</span></li><br><li class="L2"><span class="lit">11</span><span class="pun">:</span> <span class="str">‘北京’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">12</span><span class="pun">:</span> <span class="str">‘天津’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">13</span><span class="pun">:</span> <span class="str">‘河北’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">14</span><span class="pun">:</span> <span class="str">‘山西’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">15</span><span class="pun">:</span> <span class="str">‘内蒙古’</span><span class="pun">,</span></li><br><li class="L7"><span class="lit">21</span><span class="pun">:</span> <span class="str">‘辽宁’</span><span class="pun">,</span></li><br><li class="L8"><span class="lit">22</span><span class="pun">:</span> <span class="str">‘吉林’</span><span class="pun">,</span></li><br><li class="L9"><span class="lit">23</span><span class="pun">:</span> <span class="str">‘黑龙江’</span><span class="pun">,</span></li><br><li class="L0"><span class="lit">31</span><span class="pun">:</span> <span class="str">‘上海’</span><span class="pun">,</span></li><br><li class="L1"><span class="lit">32</span><span class="pun">:</span> <span class="str">‘江苏’</span><span class="pun">,</span></li><br><li class="L2"><span class="lit">33</span><span class="pun">:</span> <span class="str">‘浙江’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">34</span><span class="pun">:</span> <span class="str">‘安徽’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">35</span><span class="pun">:</span> <span class="str">‘福建’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">36</span><span class="pun">:</span> <span class="str">‘江西’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">37</span><span class="pun">:</span> <span class="str">‘山东’</span><span class="pun">,</span></li><br><li class="L7"><span class="lit">41</span><span class="pun">:</span> <span class="str">‘河南’</span><span class="pun">,</span></li><br><li class="L8"><span class="lit">42</span><span class="pun">:</span> <span class="str">‘湖北’</span><span class="pun">,</span></li><br><li class="L9"><span class="lit">43</span><span class="pun">:</span> <span class="str">‘湖南’</span><span class="pun">,</span></li><br><li class="L0"><span class="lit">44</span><span class="pun">:</span> <span class="str">‘广东’</span><span class="pun">,</span></li><br><li class="L1"><span class="lit">45</span><span class="pun">:</span> <span class="str">‘广西’</span><span class="pun">,</span></li><br><li class="L2"><span class="lit">46</span><span class="pun">:</span> <span class="str">‘海南’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">50</span><span class="pun">:</span> <span class="str">‘重庆’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">51</span><span class="pun">:</span> <span class="str">‘四川’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">52</span><span class="pun">:</span> <span class="str">‘贵州’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">53</span><span class="pun">:</span> <span class="str">‘云南’</span><span class="pun">,</span></li><br><li class="L7"><span class="lit">54</span><span class="pun">:</span> <span class="str">‘西藏’</span><span class="pun">,</span></li><br><li class="L8"><span class="lit">61</span><span class="pun">:</span> <span class="str">‘陕西’</span><span class="pun">,</span></li><br><li class="L9"><span class="lit">62</span><span class="pun">:</span> <span class="str">‘甘肃’</span><span class="pun">,</span></li><br><li class="L0"><span class="lit">63</span><span class="pun">:</span> <span class="str">‘青海’</span><span class="pun">,</span></li><br><li class="L1"><span class="lit">64</span><span class="pun">:</span> <span class="str">‘宁夏’</span><span class="pun">,</span></li><br><li class="L2"><span class="lit">65</span><span class="pun">:</span> <span class="str">‘新疆’</span><span class="pun">,</span></li><br><li class="L3"><span class="lit">71</span><span class="pun">:</span> <span class="str">‘台湾’</span><span class="pun">,</span></li><br><li class="L4"><span class="lit">81</span><span class="pun">:</span> <span class="str">‘香港’</span><span class="pun">,</span></li><br><li class="L5"><span class="lit">82</span><span class="pun">:</span> <span class="str">‘澳门’</span><span class="pun">,</span></li><br><li class="L6"><span class="lit">91</span><span class="pun">:</span> <span class="str">‘国外’</span></li><br><li class="L7"><span class="pun">};</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">aCity</span><span class="pun">[</span><span class="pln">numbers</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span> <span class="pun">+</span><span class="pln"> numbers</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]])</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘身份证格式有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> wi </span><span class="pun">=</span> <span class="pun">[</span><span class="lit">7</span><span class="pun">,</span> <span class="lit">9</span><span class="pun">,</span> <span class="lit">10</span><span class="pun">,</span> <span class="lit">5</span><span class="pun">,</span> <span class="lit">8</span><span class="pun">,</span> <span class="lit">4</span><span class="pun">,</span> <span class="lit">2</span><span class="pun">,</span> <span class="lit">1</span><span class="pun">,</span> <span class="lit">6</span><span class="pun">,</span> <span class="lit">3</span><span class="pun">,</span> <span class="lit">7</span><span class="pun">,</span> <span class="lit">9</span><span class="pun">,</span> <span class="lit">10</span><span class="pun">,</span> <span class="lit">5</span><span class="pun">,</span> <span class="lit">8</span><span class="pun">,</span> <span class="lit">4</span><span class="pun">,</span> <span class="lit">2</span><span class="pun">];</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> check </span><span class="pun">=</span> <span class="pun">[</span><span class="str">‘1’</span><span class="pun">,</span> <span class="str">‘0’</span><span class="pun">,</span> <span class="str">‘x’</span><span class="pun">,</span> <span class="str">‘9’</span><span class="pun">,</span> <span class="str">‘8’</span><span class="pun">,</span> <span class="str">‘7’</span><span class="pun">,</span> <span class="str">‘6’</span><span class="pun">,</span> <span class="str">‘5’</span><span class="pun">,</span> <span class="str">‘4’</span><span class="pun">,</span> <span class="str">‘3’</span><span class="pun">,</span> <span class="str">‘2’</span><span class="pun">];</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> _sum </span><span class="pun">=</span> <span class="lit">0</span><span class="pun">;</span></li><br><li class="L5"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span> <span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span> <span class="lit">17</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> _sum </span><span class="pun">+=</span> <span class="pun">+</span><span class="pln">numbers</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span> <span class="pun"><em></em></span> <span class="pun">+</span><span class="pln">wi</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></li><br><li class="L7"><span class="pun">}</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">numbers</span><span class="pun">[</span><span class="lit">17</span><span class="pun">]</span> <span class="pun">!=</span><span class="pln"> check</span><span class="pun">[</span><span class="pln">_sum </span><span class="pun">%</span> <span class="lit">11</span><span class="pun">])</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘身份证格式有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L0"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L3"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L4"><span class="pun">}</span></li><br><li class="L5"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入18位身份证！’</span><span class="pun">);</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="pun">},</span></li><br><li class="L0"><span class="str">‘taibaozheng’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">taibaozheng</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L7"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘台胞证格式有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L8"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L9"><span class="pun">}</span></li><br><li class="L0"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">},</span></li><br><li class="L3"><span class="str">‘zhizhao’</span><span class="pun">:</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> success</span><span class="pun">,</span><span class="pln"> fail</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L4"><span class="kwd">var</span><span class="pln"> value </span><span class="pun">=</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">val</span><span class="pun">();</span></li><br><li class="L5"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">value </span><span class="pun">===</span> <span class="str">‘’</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">constants</span><span class="pun">.</span><span class="pln">zhizhao</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">value</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L0"><span class="kwd">var</span><span class="pln"> p </span><span class="pun">=</span> <span class="lit">10</span><span class="pun">;</span></li><br><li class="L1"><span class="kwd">var</span><span class="pln"> s</span><span class="pun">;</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> a</span><span class="pun">;</span></li><br><li class="L3"><span class="kwd">var</span><span class="pln"> numbers </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">‘’</span><span class="pun">);</span></li><br><li class="L4"><span class="kwd">for</span> <span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span> <span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span> <span class="lit">15</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span> <span class="pun">{</span></li><br><li class="L5"><span class="pln"> a </span><span class="pun">=</span> <span class="pun">+</span><span class="pln">numbers</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></li><br><li class="L6"><span class="pln"> s </span><span class="pun">=</span> <span class="pun">(</span><span class="pln">p </span><span class="pun">%</span> <span class="lit">11</span><span class="pun">)</span> <span class="pun">+</span><span class="pln"> a</span><span class="pun">;</span></li><br><li class="L7"><span class="pln"> p </span><span class="pun">=</span> <span class="pun">(</span><span class="pln">s </span><span class="pun">%</span> <span class="lit">10</span><span class="pun">)</span> <span class="pun"></span> <span class="lit">2</span><span class="pun">;</span></li><br><li class="L8"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">p </span><span class="pun">===</span> <span class="lit">0</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L9"><span class="pln"> p </span><span class="pun">=</span> <span class="lit">20</span><span class="pun">;</span></li><br><li class="L0"><span class="pun">}</span></li><br><li class="L1"><span class="pun">}</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">s </span><span class="pun">%</span> <span class="lit">10</span> <span class="pun">!==</span> <span class="lit">1</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘工商营业执照输入有误，请检查后重新输入！’</span><span class="pun">);</span></li><br><li class="L4"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pln"> success</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L7"><span class="kwd">return</span> <span class="kwd">true</span><span class="pun">;</span></li><br><li class="L8"><span class="pun">}</span></li><br><li class="L9"><span class="kwd">else</span> <span class="pun">{</span></li><br><li class="L0"><span class="pln"> fail</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘请输入15位工商营业执照！’</span><span class="pun">);</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">false</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">}</span></li><br><li class="L3"><span class="pun">}</span></li><br><li class="L4"><span class="pun">};</span></li><br></ol><br></div><br><div class="jspVerticalBar"></div><br><div class="jspHorizontalBar"></div><br></div><br><p>&nbsp;</p><br><p>&nbsp;</p><br><h2>添加验证规则</h2><br><p>说好的支持自定义验证规则呢？放心，不会少的，而且超简单：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation </span><span class="pun">=</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">condition</span><span class="pun">,</span><span class="pln"> process</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> $</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">.</span><span class="pln">strategy</span><span class="pun">[</span><span class="pln">condition</span><span class="pun">]</span> <span class="pun">=</span><span class="pln"> process</span><span class="pun">;</span></li><br><li class="L2"><span class="pun">};</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>加个静态方法搞定。</p><br><h2>手动发起验证</h2><br><p>有些场景下需要手动check一下表单内容才放心吧：</p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">fn</span><span class="pun">.</span><span class="kwd">exec</span> <span class="pun">=</span> <span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li><br><li class="L1"><span class="kwd">return</span> <span class="kwd">this</span><span class="pun">.</span><span class="pln">each</span><span class="pun">(</span><span class="kwd">function</span> <span class="pun">()</span> <span class="pun">{</span></li><br><li class="L2"><span class="kwd">var</span><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span></li><br><li class="L3"><span class="kwd">if</span> <span class="pun">(!</span><span class="pln">$this</span><span class="pun">.</span><span class="kwd">is</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">))</span> <span class="pun">{</span></li><br><li class="L4"><span class="pln"> $this </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="str">‘:input’</span><span class="pun">);</span></li><br><li class="L5"><span class="pun">}</span></li><br><li class="L6"><span class="pln"> $this</span><span class="pun">.</span><span class="pln">blur</span><span class="pun">();</span></li><br><li class="L7"><span class="pun">});</span></li><br><li class="L8"><span class="pun">};</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>原理很简单，对:input子元素触发一次blur事件。</p><br><h2>还有一些是我没有做的</h2><br><p>都不是很复杂，因为我的业务场景不关注这些，所以就懒过去了。</p><br><ol><br><li>没做通用的ajax验证<br><br>现在对于ajax的验证，可以这样做：<p></p><br><div class="jspContainer"><br><div class="jspPane"><br><ol class="linenums"><br><li class="L0"><span class="pln">$</span><span class="pun">.</span><span class="pln">validation</span><span class="pun">(</span><span class="str">‘ajax_xx’</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> f</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L1"><span class="pln"> $</span><span class="pun">.</span><span class="pln">post</span><span class="pun">(</span><span class="str">‘some_url’</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">data</span><span class="pun">){</span></li><br><li class="L2"><span class="kwd">if</span> <span class="pun">(</span><span class="pln">data</span><span class="pun">.</span><span class="pln">success</span><span class="pun">)</span> <span class="pun">{</span></li><br><li class="L3"><span class="pln"> s</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">();</span></li><br><li class="L4"><span class="pun">}</span><span class="kwd">else</span><span class="pun">{</span></li><br><li class="L5"><span class="pln"> f</span><span class="pun">.</span><span class="pln">fire</span><span class="pun">(</span><span class="str">‘xxxxxxxx’</span><span class="pun">);</span></li><br><li class="L6"><span class="pun">}</span></li><br><li class="L7"><span class="pun">});</span></li><br><li class="L8"><span class="pun">});</span></li><br></ol><br></div><br></div><br><p>&nbsp;</p><br><p>表单提交前，除了检查有没有.has-error的元素找到填写出错项，还要检查有没有.wait元素，如果有的话都不能立刻提交。<br><br>如果要有一个通用的ajax验证机制，可以自行扩展<em>$.validation</em>方法</p></li><br><li>没做验证失败时表单提交阻断<br><br>正如上一条中说的，表单提交前，需要检查.has-error和.wait元素，可以自行扩展<em>$.fn.validation</em>方法，添加form的submit事件绑定。</li><br><li>没有为handle验证状态的dom操作提供接口<br><br>不想做，bootstrap挺好的。</li><br><li>没有测试用例<br><br>不打算给这些代码添加逻辑了，不想写测试用例。</li><br></ol><br><h2>下载</h2><br><p><a href="http://zhouhua.qiniudn.com//wp-content/uploads/2015/04/validation.js" target="_blank">validation.js</a></p><br><blockquote><p>博客地址：<a href="http://www.zhouhua.info/2015/04/15/validation/" target="_blank">http://www.zhouhua.info/2015/04/15/validation/</a></p></blockquote>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-108ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/108ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/108ver/">谈谈正则表达式中的“.”</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p></p><p>转自<a href="http://www.gbtags.com/gb/share/5191.htm" target="_blank" rel="external">http://www.gbtags.com/gb/share/5191.htm</a></p><p></p>
<p></p><p>好久没更新内容了，今天分享一个小的知识点，一个正则表达式方面的很容易被人忽视的坑。</p><p></p>
<p></p><p>我们知道，正则表达式中，可以用 . 表示任意单个字符，但在underscore和jquery的源代码中，我们可以看到，这些著名类库的代码中，经常并不是用 . 来表示任意字符，而是使用 [\w\W] 或者[\s\S] 。乍一看，好像表达的含义是一样的，可是为什么放着简单的方法不用，而去多绕个圈子？今天就简单说说这个问题。</p><p></p>
<p></p><p>首先我们必须要正确理解 . 的含义。其实说它表示任意单个字符，可能会让人产生误解，必须要强调一下，这个“任意单个字符”不包括控制换行的字符，也就是不包含 \n \r \u2028 或\u2029 这几个字符。而 \W 和 \s 中是能够包含这些字符的。那个这两种写法的差异也就很清晰了，就是能否匹配到几个换行控制符的差异。</p><p></p>
<p></p><p>那么在什么时候我们需要考虑这几个换行控制符呢？当要处理的字符串可能包含换行时。这样的情景太多了，处理html字符串、处理template、nodejs读取文本等等。</p><p></p>
<p></p><p>提及多行文本的场景，我们很容易想到正则表达式的 m 模式（多行模式）。那么多行模式对我们今天讨论的问题有影响吗？我不是很确定。为什么不确定呢？有些人信誓旦旦地声称单行模式下 . 的含义与多行模式下不同，单选模式下等同于 [\w\W] 或者 [\s\S] ，而多行模式下会排除换行控制符。但据我试验，以及参考MDN的说法，这是不对的。的确有很多语言的正则表达式会有上述特性，但在javascript中我没有看到，不知道会不会有浏览器方面的差异。那么多行模式对于javascript而言影响的是什么呢？我认为仅仅是改变了 ^ 和 $ 标识的含义：单行模式下，分别表示整个字符串的开始的结尾；多行模式下表示每一行的开始和结尾。而不管多行模式还是单行模式，我认为 . 都是不包含换行控制字符的，等价于 [^\n\r\u2028\u2029] 。</p><p></p>
<p></p><p>再多延伸一点点，对于<strong>现代浏览器</strong>，可以直接用 [^] 来匹配任意字符的。</p><p></p>
<p></p><p>例子程序不想写了，有兴趣的可以自己试验一下，分别用 /.<em>/g 、 /^.</em>$/g 、 /.<em>/gm 、/^.</em>$/gm 来匹配一下 “abc\nedf” ，其中道理不言自明。</p><p></p>
<blockquote><p>博客地址：<a href="http://www.zhouhua.info/2015/05/07/dot/" target="_blank">http://www.zhouhua.info/2015/05/07/dot/</a></p></blockquote>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-109ver" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/21/109ver/" class="article-date">
  	<time datetime="2015-10-21T14:57:05.755Z" itemprop="datePublished">2015-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/21/109ver/">写个CSS3缓动页面切换效果</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&nbsp;</p><br><blockquote><p>demo:<a href="http://www.old.com/demo/CSS%E7%BC%93%E5%8A%A8/" target="_blank" rel="external">点击演示</a></p><br><p>代码下载: <a href="http://pan.baidu.com/s/1pJoQhCn" target="_blank" rel="external">http://pan.baidu.com/s/1pJoQhCn</a></p></blockquote><br><p>&nbsp;</p><br><blockquote><br><h3><span style="color: #333333;"><strong>分析</strong></span></h3><br><p>因为是用纯CSS3写的.并且代码量比较多这里只简单分析一下原理</p><br><p>首先导航用的是input的check属性来实现的.. 另外用到了CSS选择器”+”与”~”</p><br><p>动画效果利用的是transition和transiform</p><br><p>通过点击导航来更改.content的Y定位实现切换</p><br><p>标题和菜单动画则通过自定义动画来实现</p></blockquote><br><p>&nbsp;</p><br><p>&nbsp;</p><br><p>&nbsp;</p><br><p>&nbsp;</p>





      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/14/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/16/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Soul
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>